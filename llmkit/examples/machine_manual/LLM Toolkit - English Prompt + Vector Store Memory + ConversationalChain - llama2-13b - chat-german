{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1tL9nRi-0j4MypyaUjDSiue-YibVpaXHQ","timestamp":1701079348910},{"file_id":"16lYsnfKr-x3TG7iU1IV-Y8nZlyc_NgZZ","timestamp":1700735356047},{"file_id":"1pva39kHCzJFxOI9c1CW_4tcxZJJy3qyo","timestamp":1700729458945},{"file_id":"18zM4SQg5qbtsb0K2x4skob5nU2MlpEmm","timestamp":1700638336539},{"file_id":"14fjYCt48f79SYKZELqUFWdlddwoJc7Ju","timestamp":1697713892289},{"file_id":"1PdWY57nGk4EB8bRM3t05EjR8ab_MbxH1","timestamp":1696602099329},{"file_id":"177CVK3nuHTP8mwEDe0oy50UxUKSSpRRv","timestamp":1694695391509},{"file_id":"1DY_WLsFWy4zf0IBs9S1k8qc1JwTgfyFF","timestamp":1694624577197},{"file_id":"1bARZZnxF8lYBxtPGYFtMD7Rfc9-ckbzz","timestamp":1689157906094},{"file_id":"1JwzfVRZMEUSRhZZldDZrz5s-MyjkGn-i","timestamp":1688544410653}],"gpuType":"V100","machine_shape":"hm","collapsed_sections":["jxUrrRCHu6Fk"]},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"a3d2a2fdf79a40e1a9242a3ce069f66a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_37a0e1bc36f647b791f799ab0d75347b","IPY_MODEL_846d1a1c29cd4b9ea965d9c22a90544b","IPY_MODEL_ff3390abc1544c389baf1308346f9cd9"],"layout":"IPY_MODEL_484bb71d1a854a8db399ddcda20cfcf7"}},"37a0e1bc36f647b791f799ab0d75347b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5cd2621dec4543169dfd763e244927e1","placeholder":"​","style":"IPY_MODEL_9344a2d4a980437285205f9d33519f1d","value":"Loading checkpoint shards: 100%"}},"846d1a1c29cd4b9ea965d9c22a90544b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2f7f01979d5e4136a1d8b530c2a766d2","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_167b76fd13c448a8a444eb4af2671edc","value":3}},"ff3390abc1544c389baf1308346f9cd9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bd694ccfdb9246b28ad10cd020b42392","placeholder":"​","style":"IPY_MODEL_bb90f4def77748568de4e9d0839b02e8","value":" 3/3 [08:02&lt;00:00, 151.52s/it]"}},"484bb71d1a854a8db399ddcda20cfcf7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5cd2621dec4543169dfd763e244927e1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9344a2d4a980437285205f9d33519f1d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2f7f01979d5e4136a1d8b530c2a766d2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"167b76fd13c448a8a444eb4af2671edc":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bd694ccfdb9246b28ad10cd020b42392":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bb90f4def77748568de4e9d0839b02e8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"632af86211a24943bbe487d60c7020df":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_22bbee6a4a7b4f178b8cb87f60b14272","IPY_MODEL_076288fe2f1a48b4b2d5e1ad2f080435","IPY_MODEL_2200087682624d37bfdbc5d546fd5752"],"layout":"IPY_MODEL_e025d6f6caf04df585b3c9af5df734c0"}},"22bbee6a4a7b4f178b8cb87f60b14272":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cf4449a1e42a425ea7287f51dffdc722","placeholder":"​","style":"IPY_MODEL_1f4ba60c14414887909a1d1408006a43","value":".gitattributes: 100%"}},"076288fe2f1a48b4b2d5e1ad2f080435":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4a1a0c7ad8f249cc9c45060b5f2d9008","max":496,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3a2d3aa5cf4049709922ab1e50d85a87","value":496}},"2200087682624d37bfdbc5d546fd5752":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f887567d5e844384835aac8f3bf83069","placeholder":"​","style":"IPY_MODEL_c976f9ee7242497cae2e7cc6bfe24f32","value":" 496/496 [00:00&lt;00:00, 44.5kB/s]"}},"e025d6f6caf04df585b3c9af5df734c0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cf4449a1e42a425ea7287f51dffdc722":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1f4ba60c14414887909a1d1408006a43":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4a1a0c7ad8f249cc9c45060b5f2d9008":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3a2d3aa5cf4049709922ab1e50d85a87":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f887567d5e844384835aac8f3bf83069":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c976f9ee7242497cae2e7cc6bfe24f32":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c0be08a7e9c844bf85b51365a034e70a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1c579cfb01a24ce2ade11d26c2d2465b","IPY_MODEL_6bd1ed4f094147b093f402f53f9dcddc","IPY_MODEL_ed5e1a58b3824393bc286eccc0b13ede"],"layout":"IPY_MODEL_52d8741fca4f427b8b849f217a9fe3de"}},"1c579cfb01a24ce2ade11d26c2d2465b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0b317ea83ba247a79b7da496ee537983","placeholder":"​","style":"IPY_MODEL_0ed2f027cc534f2eabec204abc10ee97","value":"README.md: 100%"}},"6bd1ed4f094147b093f402f53f9dcddc":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0de64c98cd854324abafce1b46ce0559","max":4412,"min":0,"orientation":"horizontal","style":"IPY_MODEL_dab9121562d24e6782fb62109ef7f69b","value":4412}},"ed5e1a58b3824393bc286eccc0b13ede":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7493ee7556774eaa827ee7e995c57234","placeholder":"​","style":"IPY_MODEL_24106676ae184a0a9534ac5343f92934","value":" 4.41k/4.41k [00:00&lt;00:00, 380kB/s]"}},"52d8741fca4f427b8b849f217a9fe3de":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0b317ea83ba247a79b7da496ee537983":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0ed2f027cc534f2eabec204abc10ee97":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0de64c98cd854324abafce1b46ce0559":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dab9121562d24e6782fb62109ef7f69b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7493ee7556774eaa827ee7e995c57234":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"24106676ae184a0a9534ac5343f92934":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d0fedd2b7a1b451f9b2b11ba786e66a8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0d6432922b844a548129cfa7b1c1f12a","IPY_MODEL_56377aac9edb4e358d4d63d0050c2b26","IPY_MODEL_6adc5089cdc54f379345ff2a5473db8b"],"layout":"IPY_MODEL_c16833ad9bce4c508d05ba37ed5006da"}},"0d6432922b844a548129cfa7b1c1f12a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a6520af696874526a0826b772c1f5bdb","placeholder":"​","style":"IPY_MODEL_b92fab187a5348e28c22ecf65a0ea17e","value":"config.json: 100%"}},"56377aac9edb4e358d4d63d0050c2b26":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_192c6bc8070248329f31b26a903c9b8f","max":611,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3eb87592d45345439c8298ede1b3d3ed","value":611}},"6adc5089cdc54f379345ff2a5473db8b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5a345fc695164bf9acd1af3627c04c12","placeholder":"​","style":"IPY_MODEL_a63a4b3fe9fa4990be9710b8de874c11","value":" 611/611 [00:00&lt;00:00, 57.5kB/s]"}},"c16833ad9bce4c508d05ba37ed5006da":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a6520af696874526a0826b772c1f5bdb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b92fab187a5348e28c22ecf65a0ea17e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"192c6bc8070248329f31b26a903c9b8f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3eb87592d45345439c8298ede1b3d3ed":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5a345fc695164bf9acd1af3627c04c12":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a63a4b3fe9fa4990be9710b8de874c11":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0c7a74cbe30649ab9c50eaf8237d0e58":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3293fba4a82d4ce89974bb61d29a77f6","IPY_MODEL_a8381e8a070f420cb9822d83d35d5c29","IPY_MODEL_f7bc999f244a449fabf602411ac56cf9"],"layout":"IPY_MODEL_a2655d0985ba4386a26a46d65903e469"}},"3293fba4a82d4ce89974bb61d29a77f6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d052c343779346d695d0b903047be768","placeholder":"​","style":"IPY_MODEL_2da06e9da09245cf8aa886c4350e187b","value":"model.safetensors: 100%"}},"a8381e8a070f420cb9822d83d35d5c29":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_a2b6339e5d544c85b4cd057d5928ed09","max":1883734344,"min":0,"orientation":"horizontal","style":"IPY_MODEL_fa13f8533dff45ba90d1eff1543efe52","value":1883734344}},"f7bc999f244a449fabf602411ac56cf9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2a6ed7644c7b4decb3e40d25bfbb8db4","placeholder":"​","style":"IPY_MODEL_e589947dcbeb44b49bf63692cb119daa","value":" 1.88G/1.88G [00:07&lt;00:00, 237MB/s]"}},"a2655d0985ba4386a26a46d65903e469":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d052c343779346d695d0b903047be768":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2da06e9da09245cf8aa886c4350e187b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a2b6339e5d544c85b4cd057d5928ed09":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fa13f8533dff45ba90d1eff1543efe52":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2a6ed7644c7b4decb3e40d25bfbb8db4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e589947dcbeb44b49bf63692cb119daa":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4f3d60fc71b54739ac7627dbc4204193":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_fd74be972f454810b16b9c1ce7f2dd39","IPY_MODEL_126c0355b70f402aac58a0c8ab3c187a","IPY_MODEL_92ba76c92ba74cc8ab1e06e432fb60c8"],"layout":"IPY_MODEL_c6662e45d251418687da79f900211604"}},"fd74be972f454810b16b9c1ce7f2dd39":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_11a7dd54595b47cb8779447de221e5aa","placeholder":"​","style":"IPY_MODEL_8e8a11a78d8c44ad8337faefba07223f","value":"pytorch_model.bin: 100%"}},"126c0355b70f402aac58a0c8ab3c187a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_dd8f020bced74850b043783a1545c63c","max":1883775789,"min":0,"orientation":"horizontal","style":"IPY_MODEL_174116a9f0b14fc8a171f3119c8dbd60","value":1883775789}},"92ba76c92ba74cc8ab1e06e432fb60c8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a8e2bba6e2814003848849d7c493fb95","placeholder":"​","style":"IPY_MODEL_c91d345efa264d29ab7354f4407ea240","value":" 1.88G/1.88G [02:38&lt;00:00, 12.1MB/s]"}},"c6662e45d251418687da79f900211604":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"11a7dd54595b47cb8779447de221e5aa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8e8a11a78d8c44ad8337faefba07223f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"dd8f020bced74850b043783a1545c63c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"174116a9f0b14fc8a171f3119c8dbd60":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a8e2bba6e2814003848849d7c493fb95":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c91d345efa264d29ab7354f4407ea240":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"930446ebe40b444589c9552156da0516":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0854da0176644a5b81f2da8f77aa7408","IPY_MODEL_90d70d9edc2d46afaa16b6107fe6b1ce","IPY_MODEL_e87b2633706540d484180b3613dd8489"],"layout":"IPY_MODEL_99ddbf021ca54acfb953f1afdcf889f1"}},"0854da0176644a5b81f2da8f77aa7408":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d2ac161ffd574a7b976d40b2e7f1ef3e","placeholder":"​","style":"IPY_MODEL_3ae997381a1a4030ae11486506dd5e7c","value":"special_tokens_map.json: 100%"}},"90d70d9edc2d46afaa16b6107fe6b1ce":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6e6a9fa89bb4491aa6f7b03305d15557","max":125,"min":0,"orientation":"horizontal","style":"IPY_MODEL_df058edde038483aa5f2118b20a6f364","value":125}},"e87b2633706540d484180b3613dd8489":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_81d8fb74fd864e10b97c429b4f7f406c","placeholder":"​","style":"IPY_MODEL_63c6610ce7834164a54f4d3911826839","value":" 125/125 [00:00&lt;00:00, 10.2kB/s]"}},"99ddbf021ca54acfb953f1afdcf889f1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d2ac161ffd574a7b976d40b2e7f1ef3e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3ae997381a1a4030ae11486506dd5e7c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6e6a9fa89bb4491aa6f7b03305d15557":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"df058edde038483aa5f2118b20a6f364":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"81d8fb74fd864e10b97c429b4f7f406c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"63c6610ce7834164a54f4d3911826839":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3398f339d3664c0287c0849d3f05f985":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_86565be7d8c448e3bba0dc0fbbda5702","IPY_MODEL_cc9cff8caffb4c339938e7e3b05d53d1","IPY_MODEL_ee459d4b83e244df97ecddaf8490475d"],"layout":"IPY_MODEL_ab5cef6afe174abd8c6e6a06a67d7fa4"}},"86565be7d8c448e3bba0dc0fbbda5702":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_624f43d05eb44b35a3f1f49059c605b1","placeholder":"​","style":"IPY_MODEL_1c115ae123234d3d82381d0e8e441a06","value":"tokenizer.json: 100%"}},"cc9cff8caffb4c339938e7e3b05d53d1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6922a6c4443d496da1d3b58f8977b9db","max":13631023,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b5677d1fa4d64e88a3b254f98ac2b3c5","value":13631023}},"ee459d4b83e244df97ecddaf8490475d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f39baaedcd3846268cf0af373e813f18","placeholder":"​","style":"IPY_MODEL_cb806e6d93d742d5acddb00a802d4f15","value":" 13.6M/13.6M [00:00&lt;00:00, 210MB/s]"}},"ab5cef6afe174abd8c6e6a06a67d7fa4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"624f43d05eb44b35a3f1f49059c605b1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1c115ae123234d3d82381d0e8e441a06":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6922a6c4443d496da1d3b58f8977b9db":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b5677d1fa4d64e88a3b254f98ac2b3c5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f39baaedcd3846268cf0af373e813f18":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cb806e6d93d742d5acddb00a802d4f15":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3f355e6df02e465f91197d821ab4e809":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_bde588f53b044dcda317ba032bdf6f83","IPY_MODEL_507b7f856a5c4b7590a7dcd6ab1cb70a","IPY_MODEL_71bbe8eb74aa4f509e67c0b7a79a87ca"],"layout":"IPY_MODEL_f1aaadde40404f6db591ad2ef846d2e4"}},"bde588f53b044dcda317ba032bdf6f83":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_130002a92a4e4cbe9c0bef459b37c41b","placeholder":"​","style":"IPY_MODEL_2ba8a85bb9ba4ced91f3703c1ae5ef73","value":"tokenizer_config.json: 100%"}},"507b7f856a5c4b7590a7dcd6ab1cb70a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_23f754fe52a34897924c5099451f4343","max":367,"min":0,"orientation":"horizontal","style":"IPY_MODEL_431032b3a2b44859abff150574d06b02","value":367}},"71bbe8eb74aa4f509e67c0b7a79a87ca":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b8b7b45c9a934769bf676cd3e48b6ff3","placeholder":"​","style":"IPY_MODEL_71ce7559b6e846c088383bd65bb8c07b","value":" 367/367 [00:00&lt;00:00, 28.6kB/s]"}},"f1aaadde40404f6db591ad2ef846d2e4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"130002a92a4e4cbe9c0bef459b37c41b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2ba8a85bb9ba4ced91f3703c1ae5ef73":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"23f754fe52a34897924c5099451f4343":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"431032b3a2b44859abff150574d06b02":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b8b7b45c9a934769bf676cd3e48b6ff3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"71ce7559b6e846c088383bd65bb8c07b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"61c81e1435754f2c885ae1ef4467fdef":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f7c41c636c5240db86b8a1a3320f1cf6","IPY_MODEL_9a31ed61756d47e6a55ff2405eb43b9f","IPY_MODEL_7f75ab6b11ff455c9f344e78b1682a02"],"layout":"IPY_MODEL_2003e152909f4b34b939f4065c50ab38"}},"f7c41c636c5240db86b8a1a3320f1cf6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e1312916cebf4cc6a9cead62a04220e5","placeholder":"​","style":"IPY_MODEL_a7e5e5b465da4540b3993edc0556f024","value":"vocab.txt: 100%"}},"9a31ed61756d47e6a55ff2405eb43b9f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_05c4c46236f7476a892c0505905164d2","max":5220781,"min":0,"orientation":"horizontal","style":"IPY_MODEL_39e907d920b543bfbcabf30ac379cc24","value":5220781}},"7f75ab6b11ff455c9f344e78b1682a02":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5f1a2f8a22334becae10c3b9165a2588","placeholder":"​","style":"IPY_MODEL_00e2fcf3c13e47d39be1780eb8477a58","value":" 5.22M/5.22M [00:01&lt;00:00, 4.22MB/s]"}},"2003e152909f4b34b939f4065c50ab38":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e1312916cebf4cc6a9cead62a04220e5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a7e5e5b465da4540b3993edc0556f024":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"05c4c46236f7476a892c0505905164d2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"39e907d920b543bfbcabf30ac379cc24":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5f1a2f8a22334becae10c3b9165a2588":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"00e2fcf3c13e47d39be1780eb8477a58":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["# Scenario 5 : Lama2-13b-chat-german model\n","\n","\n","*   With Conversation chain\n","*   With English Prompt\n","*   Vector store memory - keeping memory in vector store and then retrieving the most relevant memory based on the question asked.\n","*   Machine Manual Truncated (page 6-41 based on discussions)\n","\n","**Prompt (Default llama2)**:\n","\n","You are a helpful, respectful and honest assistant. Always answer as helpfully as possible, while being safe. Your answers should not include any harmful, unethical, racist, sexist, toxic, dangerous, or illegal content. Please ensure that your responses are socially unbiased and positive in nature.\n","\n","If a question does not make any sense, or is not factually coherent, explain why instead of answering something not correct. If you don't know the answer to a question, please don't share false information.\n","\n","\n","\n","### Usage V100 Crashes:\n","With 16 GB of GPU :\n","\n","*   15 GB for model and embedder\n","*   5 GB of RAM (in use)\n","\n","***Colab Cost: Approx 5.45 units/hour***\n"],"metadata":{"id":"USwmqbq0UIVP"}},{"cell_type":"code","source":["experiment_name = \"scenario_5\" # going to be used as a file name to store results"],"metadata":{"id":"WjQKe95uyrw7","executionInfo":{"status":"ok","timestamp":1701268775484,"user_tz":-60,"elapsed":515,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":1,"outputs":[]},{"cell_type":"code","execution_count":2,"metadata":{"id":"kzbdMaFiKhGO","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701268821262,"user_tz":-60,"elapsed":44234,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"07b2f3a5-2087-40e2-a00e-b63a1ca14342"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting langchain\n","  Downloading langchain-0.0.342-py3-none-any.whl (1.9 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.9/1.9 MB\u001b[0m \u001b[31m29.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting tiktoken\n","  Downloading tiktoken-0.5.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.0/2.0 MB\u001b[0m \u001b[31m84.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting chromadb\n","  Downloading chromadb-0.4.18-py3-none-any.whl (502 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m502.4/502.4 kB\u001b[0m \u001b[31m52.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting einops\n","  Downloading einops-0.7.0-py3-none-any.whl (44 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m44.6/44.6 kB\u001b[0m \u001b[31m6.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: transformers in /usr/local/lib/python3.10/dist-packages (4.35.2)\n","Collecting InstructorEmbedding\n","  Downloading InstructorEmbedding-1.0.1-py2.py3-none-any.whl (19 kB)\n","Collecting accelerate\n","  Downloading accelerate-0.24.1-py3-none-any.whl (261 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m261.4/261.4 kB\u001b[0m \u001b[31m31.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting bitsandbytes\n","  Downloading bitsandbytes-0.41.2.post2-py3-none-any.whl (92.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m92.6/92.6 MB\u001b[0m \u001b[31m20.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting sentencepiece\n","  Downloading sentencepiece-0.1.99-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m87.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting Xformers\n","  Downloading xformers-0.0.22.post7-cp310-cp310-manylinux2014_x86_64.whl (211.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m211.8/211.8 MB\u001b[0m \u001b[31m3.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting sentence-transformers\n","  Downloading sentence-transformers-2.2.2.tar.gz (85 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m86.0/86.0 kB\u001b[0m \u001b[31m13.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Collecting pymupdf\n","  Downloading PyMuPDF-1.23.6-cp310-none-manylinux2014_x86_64.whl (4.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m4.3/4.3 MB\u001b[0m \u001b[31m43.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: safetensors in /usr/local/lib/python3.10/dist-packages (0.4.0)\n","Collecting aleph_alpha_client\n","  Downloading aleph_alpha_client-4.1.0-py3-none-any.whl (35 kB)\n","Requirement already satisfied: PyYAML>=5.3 in /usr/local/lib/python3.10/dist-packages (from langchain) (6.0.1)\n","Requirement already satisfied: SQLAlchemy<3,>=1.4 in /usr/local/lib/python3.10/dist-packages (from langchain) (2.0.23)\n","Requirement already satisfied: aiohttp<4.0.0,>=3.8.3 in /usr/local/lib/python3.10/dist-packages (from langchain) (3.8.6)\n","Requirement already satisfied: anyio<4.0 in /usr/local/lib/python3.10/dist-packages (from langchain) (3.7.1)\n","Requirement already satisfied: async-timeout<5.0.0,>=4.0.0 in /usr/local/lib/python3.10/dist-packages (from langchain) (4.0.3)\n","Collecting dataclasses-json<0.7,>=0.5.7 (from langchain)\n","  Downloading dataclasses_json-0.6.3-py3-none-any.whl (28 kB)\n","Collecting jsonpatch<2.0,>=1.33 (from langchain)\n","  Downloading jsonpatch-1.33-py2.py3-none-any.whl (12 kB)\n","Collecting langchain-core<0.1,>=0.0.7 (from langchain)\n","  Downloading langchain_core-0.0.7-py3-none-any.whl (177 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m177.5/177.5 kB\u001b[0m \u001b[31m25.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting langsmith<0.1.0,>=0.0.63 (from langchain)\n","  Downloading langsmith-0.0.67-py3-none-any.whl (47 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m47.0/47.0 kB\u001b[0m \u001b[31m6.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy<2,>=1 in /usr/local/lib/python3.10/dist-packages (from langchain) (1.23.5)\n","Requirement already satisfied: pydantic<3,>=1 in /usr/local/lib/python3.10/dist-packages (from langchain) (1.10.13)\n","Requirement already satisfied: requests<3,>=2 in /usr/local/lib/python3.10/dist-packages (from langchain) (2.31.0)\n","Requirement already satisfied: tenacity<9.0.0,>=8.1.0 in /usr/local/lib/python3.10/dist-packages (from langchain) (8.2.3)\n","Requirement already satisfied: regex>=2022.1.18 in /usr/local/lib/python3.10/dist-packages (from tiktoken) (2023.6.3)\n","Collecting chroma-hnswlib==0.7.3 (from chromadb)\n","  Downloading chroma_hnswlib-0.7.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.4 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.4/2.4 MB\u001b[0m \u001b[31m61.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting fastapi>=0.95.2 (from chromadb)\n","  Downloading fastapi-0.104.1-py3-none-any.whl (92 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m92.9/92.9 kB\u001b[0m \u001b[31m12.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting uvicorn[standard]>=0.18.3 (from chromadb)\n","  Downloading uvicorn-0.24.0.post1-py3-none-any.whl (59 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m59.7/59.7 kB\u001b[0m \u001b[31m9.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting posthog>=2.4.0 (from chromadb)\n","  Downloading posthog-3.0.2-py2.py3-none-any.whl (37 kB)\n","Requirement already satisfied: typing-extensions>=4.5.0 in /usr/local/lib/python3.10/dist-packages (from chromadb) (4.5.0)\n","Collecting pulsar-client>=3.1.0 (from chromadb)\n","  Downloading pulsar_client-3.3.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (5.4 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m5.4/5.4 MB\u001b[0m \u001b[31m107.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting onnxruntime>=1.14.1 (from chromadb)\n","  Downloading onnxruntime-1.16.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (6.4 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m6.4/6.4 MB\u001b[0m \u001b[31m86.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting opentelemetry-api>=1.2.0 (from chromadb)\n","  Downloading opentelemetry_api-1.21.0-py3-none-any.whl (57 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m57.9/57.9 kB\u001b[0m \u001b[31m9.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting opentelemetry-exporter-otlp-proto-grpc>=1.2.0 (from chromadb)\n","  Downloading opentelemetry_exporter_otlp_proto_grpc-1.21.0-py3-none-any.whl (18 kB)\n","Collecting opentelemetry-instrumentation-fastapi>=0.41b0 (from chromadb)\n","  Downloading opentelemetry_instrumentation_fastapi-0.42b0-py3-none-any.whl (11 kB)\n","Collecting opentelemetry-sdk>=1.2.0 (from chromadb)\n","  Downloading opentelemetry_sdk-1.21.0-py3-none-any.whl (105 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m105.3/105.3 kB\u001b[0m \u001b[31m15.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tokenizers>=0.13.2 in /usr/local/lib/python3.10/dist-packages (from chromadb) (0.15.0)\n","Collecting pypika>=0.48.9 (from chromadb)\n","  Downloading PyPika-0.48.9.tar.gz (67 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m67.3/67.3 kB\u001b[0m \u001b[31m11.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: tqdm>=4.65.0 in /usr/local/lib/python3.10/dist-packages (from chromadb) (4.66.1)\n","Collecting overrides>=7.3.1 (from chromadb)\n","  Downloading overrides-7.4.0-py3-none-any.whl (17 kB)\n","Requirement already satisfied: importlib-resources in /usr/local/lib/python3.10/dist-packages (from chromadb) (6.1.1)\n","Requirement already satisfied: grpcio>=1.58.0 in /usr/local/lib/python3.10/dist-packages (from chromadb) (1.59.2)\n","Collecting bcrypt>=4.0.1 (from chromadb)\n","  Downloading bcrypt-4.1.1-cp37-abi3-manylinux_2_28_x86_64.whl (699 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m699.4/699.4 kB\u001b[0m \u001b[31m59.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: typer>=0.9.0 in /usr/local/lib/python3.10/dist-packages (from chromadb) (0.9.0)\n","Collecting kubernetes>=28.1.0 (from chromadb)\n","  Downloading kubernetes-28.1.0-py2.py3-none-any.whl (1.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.6/1.6 MB\u001b[0m \u001b[31m91.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting mmh3>=4.0.1 (from chromadb)\n","  Downloading mmh3-4.0.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (72 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m72.6/72.6 kB\u001b[0m \u001b[31m10.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.13.1)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.16.4 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.19.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.2)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: torch>=1.10.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.1.0+cu118)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (1.12)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (3.2.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (3.1.2)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (2023.6.0)\n","Requirement already satisfied: triton==2.1.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (2.1.0)\n","Requirement already satisfied: torchvision in /usr/local/lib/python3.10/dist-packages (from sentence-transformers) (0.16.0+cu118)\n","Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (from sentence-transformers) (1.2.2)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from sentence-transformers) (1.11.3)\n","Requirement already satisfied: nltk in /usr/local/lib/python3.10/dist-packages (from sentence-transformers) (3.8.1)\n","Collecting PyMuPDFb==1.23.6 (from pymupdf)\n","  Downloading PyMuPDFb-1.23.6-py3-none-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (30.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m30.6/30.6 MB\u001b[0m \u001b[31m46.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: urllib3>=1.26 in /usr/local/lib/python3.10/dist-packages (from aleph_alpha_client) (2.0.7)\n","Collecting aiodns>=3.0.0 (from aleph_alpha_client)\n","  Downloading aiodns-3.1.1-py3-none-any.whl (5.4 kB)\n","Collecting aiohttp-retry>=2.8.3 (from aleph_alpha_client)\n","  Downloading aiohttp_retry-2.8.3-py3-none-any.whl (9.8 kB)\n","Requirement already satisfied: Pillow>=9.2.0 in /usr/local/lib/python3.10/dist-packages (from aleph_alpha_client) (9.4.0)\n","Collecting python-liquid>=1.9.4 (from aleph_alpha_client)\n","  Downloading python_liquid-1.10.0-py3-none-any.whl (199 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m199.5/199.5 kB\u001b[0m \u001b[31m29.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting pycares>=4.0.0 (from aiodns>=3.0.0->aleph_alpha_client)\n","  Downloading pycares-4.4.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (288 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m288.7/288.7 kB\u001b[0m \u001b[31m37.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain) (23.1.0)\n","Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain) (3.3.2)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain) (6.0.4)\n","Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain) (1.9.2)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain) (1.4.0)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp<4.0.0,>=3.8.3->langchain) (1.3.1)\n","Requirement already satisfied: idna>=2.8 in /usr/local/lib/python3.10/dist-packages (from anyio<4.0->langchain) (3.4)\n","Requirement already satisfied: sniffio>=1.1 in /usr/local/lib/python3.10/dist-packages (from anyio<4.0->langchain) (1.3.0)\n","Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/dist-packages (from anyio<4.0->langchain) (1.1.3)\n","Collecting marshmallow<4.0.0,>=3.18.0 (from dataclasses-json<0.7,>=0.5.7->langchain)\n","  Downloading marshmallow-3.20.1-py3-none-any.whl (49 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m49.4/49.4 kB\u001b[0m \u001b[31m7.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting typing-inspect<1,>=0.4.0 (from dataclasses-json<0.7,>=0.5.7->langchain)\n","  Downloading typing_inspect-0.9.0-py3-none-any.whl (8.8 kB)\n","Collecting starlette<0.28.0,>=0.27.0 (from fastapi>=0.95.2->chromadb)\n","  Downloading starlette-0.27.0-py3-none-any.whl (66 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m67.0/67.0 kB\u001b[0m \u001b[31m10.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting typing-extensions>=4.5.0 (from chromadb)\n","  Downloading typing_extensions-4.8.0-py3-none-any.whl (31 kB)\n","Collecting jsonpointer>=1.9 (from jsonpatch<2.0,>=1.33->langchain)\n","  Downloading jsonpointer-2.4-py2.py3-none-any.whl (7.8 kB)\n","Requirement already satisfied: certifi>=14.05.14 in /usr/local/lib/python3.10/dist-packages (from kubernetes>=28.1.0->chromadb) (2023.7.22)\n","Requirement already satisfied: six>=1.9.0 in /usr/local/lib/python3.10/dist-packages (from kubernetes>=28.1.0->chromadb) (1.16.0)\n","Requirement already satisfied: python-dateutil>=2.5.3 in /usr/local/lib/python3.10/dist-packages (from kubernetes>=28.1.0->chromadb) (2.8.2)\n","Requirement already satisfied: google-auth>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from kubernetes>=28.1.0->chromadb) (2.17.3)\n","Requirement already satisfied: websocket-client!=0.40.0,!=0.41.*,!=0.42.*,>=0.32.0 in /usr/local/lib/python3.10/dist-packages (from kubernetes>=28.1.0->chromadb) (1.6.4)\n","Requirement already satisfied: requests-oauthlib in /usr/local/lib/python3.10/dist-packages (from kubernetes>=28.1.0->chromadb) (1.3.1)\n","Requirement already satisfied: oauthlib>=3.2.2 in /usr/local/lib/python3.10/dist-packages (from kubernetes>=28.1.0->chromadb) (3.2.2)\n","Collecting urllib3>=1.26 (from aleph_alpha_client)\n","  Downloading urllib3-1.26.18-py2.py3-none-any.whl (143 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m143.8/143.8 kB\u001b[0m \u001b[31m21.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting coloredlogs (from onnxruntime>=1.14.1->chromadb)\n","  Downloading coloredlogs-15.0.1-py2.py3-none-any.whl (46 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m46.0/46.0 kB\u001b[0m \u001b[31m7.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: flatbuffers in /usr/local/lib/python3.10/dist-packages (from onnxruntime>=1.14.1->chromadb) (23.5.26)\n","Requirement already satisfied: protobuf in /usr/local/lib/python3.10/dist-packages (from onnxruntime>=1.14.1->chromadb) (3.20.3)\n","Collecting deprecated>=1.2.6 (from opentelemetry-api>=1.2.0->chromadb)\n","  Downloading Deprecated-1.2.14-py2.py3-none-any.whl (9.6 kB)\n","Requirement already satisfied: importlib-metadata<7.0,>=6.0 in /usr/local/lib/python3.10/dist-packages (from opentelemetry-api>=1.2.0->chromadb) (6.8.0)\n","Collecting backoff<3.0.0,>=1.10.0 (from opentelemetry-exporter-otlp-proto-grpc>=1.2.0->chromadb)\n","  Downloading backoff-2.2.1-py3-none-any.whl (15 kB)\n","Requirement already satisfied: googleapis-common-protos~=1.52 in /usr/local/lib/python3.10/dist-packages (from opentelemetry-exporter-otlp-proto-grpc>=1.2.0->chromadb) (1.61.0)\n","Collecting opentelemetry-exporter-otlp-proto-common==1.21.0 (from opentelemetry-exporter-otlp-proto-grpc>=1.2.0->chromadb)\n","  Downloading opentelemetry_exporter_otlp_proto_common-1.21.0-py3-none-any.whl (17 kB)\n","Collecting opentelemetry-proto==1.21.0 (from opentelemetry-exporter-otlp-proto-grpc>=1.2.0->chromadb)\n","  Downloading opentelemetry_proto-1.21.0-py3-none-any.whl (50 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m50.8/50.8 kB\u001b[0m \u001b[31m8.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting opentelemetry-instrumentation-asgi==0.42b0 (from opentelemetry-instrumentation-fastapi>=0.41b0->chromadb)\n","  Downloading opentelemetry_instrumentation_asgi-0.42b0-py3-none-any.whl (13 kB)\n","Collecting opentelemetry-instrumentation==0.42b0 (from opentelemetry-instrumentation-fastapi>=0.41b0->chromadb)\n","  Downloading opentelemetry_instrumentation-0.42b0-py3-none-any.whl (25 kB)\n","Collecting opentelemetry-semantic-conventions==0.42b0 (from opentelemetry-instrumentation-fastapi>=0.41b0->chromadb)\n","  Downloading opentelemetry_semantic_conventions-0.42b0-py3-none-any.whl (36 kB)\n","Collecting opentelemetry-util-http==0.42b0 (from opentelemetry-instrumentation-fastapi>=0.41b0->chromadb)\n","  Downloading opentelemetry_util_http-0.42b0-py3-none-any.whl (6.9 kB)\n","Requirement already satisfied: setuptools>=16.0 in /usr/local/lib/python3.10/dist-packages (from opentelemetry-instrumentation==0.42b0->opentelemetry-instrumentation-fastapi>=0.41b0->chromadb) (67.7.2)\n","Requirement already satisfied: wrapt<2.0.0,>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from opentelemetry-instrumentation==0.42b0->opentelemetry-instrumentation-fastapi>=0.41b0->chromadb) (1.14.1)\n","Collecting asgiref~=3.0 (from opentelemetry-instrumentation-asgi==0.42b0->opentelemetry-instrumentation-fastapi>=0.41b0->chromadb)\n","  Downloading asgiref-3.7.2-py3-none-any.whl (24 kB)\n","Collecting monotonic>=1.5 (from posthog>=2.4.0->chromadb)\n","  Downloading monotonic-1.6-py2.py3-none-any.whl (8.2 kB)\n","Requirement already satisfied: greenlet!=0.4.17 in /usr/local/lib/python3.10/dist-packages (from SQLAlchemy<3,>=1.4->langchain) (3.0.1)\n","Requirement already satisfied: click<9.0.0,>=7.1.1 in /usr/local/lib/python3.10/dist-packages (from typer>=0.9.0->chromadb) (8.1.7)\n","Collecting h11>=0.8 (from uvicorn[standard]>=0.18.3->chromadb)\n","  Downloading h11-0.14.0-py3-none-any.whl (58 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m58.3/58.3 kB\u001b[0m \u001b[31m9.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting httptools>=0.5.0 (from uvicorn[standard]>=0.18.3->chromadb)\n","  Downloading httptools-0.6.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (341 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m341.4/341.4 kB\u001b[0m \u001b[31m41.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting python-dotenv>=0.13 (from uvicorn[standard]>=0.18.3->chromadb)\n","  Downloading python_dotenv-1.0.0-py3-none-any.whl (19 kB)\n","Collecting uvloop!=0.15.0,!=0.15.1,>=0.14.0 (from uvicorn[standard]>=0.18.3->chromadb)\n","  Downloading uvloop-0.19.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.4 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m3.4/3.4 MB\u001b[0m \u001b[31m95.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting watchfiles>=0.13 (from uvicorn[standard]>=0.18.3->chromadb)\n","  Downloading watchfiles-0.21.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m91.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting websockets>=10.4 (from uvicorn[standard]>=0.18.3->chromadb)\n","  Downloading websockets-12.0-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (130 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m130.2/130.2 kB\u001b[0m \u001b[31m19.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: joblib in /usr/local/lib/python3.10/dist-packages (from nltk->sentence-transformers) (1.3.2)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn->sentence-transformers) (3.2.0)\n","Requirement already satisfied: cachetools<6.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth>=1.0.1->kubernetes>=28.1.0->chromadb) (5.3.2)\n","Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth>=1.0.1->kubernetes>=28.1.0->chromadb) (0.3.0)\n","Requirement already satisfied: rsa<5,>=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth>=1.0.1->kubernetes>=28.1.0->chromadb) (4.9)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.10/dist-packages (from importlib-metadata<7.0,>=6.0->opentelemetry-api>=1.2.0->chromadb) (3.17.0)\n","Requirement already satisfied: cffi>=1.5.0 in /usr/local/lib/python3.10/dist-packages (from pycares>=4.0.0->aiodns>=3.0.0->aleph_alpha_client) (1.16.0)\n","Collecting mypy-extensions>=0.3.0 (from typing-inspect<1,>=0.4.0->dataclasses-json<0.7,>=0.5.7->langchain)\n","  Downloading mypy_extensions-1.0.0-py3-none-any.whl (4.7 kB)\n","Collecting humanfriendly>=9.1 (from coloredlogs->onnxruntime>=1.14.1->chromadb)\n","  Downloading humanfriendly-10.0-py2.py3-none-any.whl (86 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m86.8/86.8 kB\u001b[0m \u001b[31m14.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.10.0->accelerate) (2.1.3)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.10.0->accelerate) (1.3.0)\n","Requirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi>=1.5.0->pycares>=4.0.0->aiodns>=3.0.0->aleph_alpha_client) (2.21)\n","Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules>=0.2.1->google-auth>=1.0.1->kubernetes>=28.1.0->chromadb) (0.5.0)\n","Building wheels for collected packages: sentence-transformers, pypika\n","  Building wheel for sentence-transformers (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for sentence-transformers: filename=sentence_transformers-2.2.2-py3-none-any.whl size=125923 sha256=0f850335f196713d758a05b08bafa3e66870f073292abad6a0e73dfb54a91bac\n","  Stored in directory: /root/.cache/pip/wheels/62/f2/10/1e606fd5f02395388f74e7462910fe851042f97238cbbd902f\n","  Building wheel for pypika (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for pypika: filename=PyPika-0.48.9-py2.py3-none-any.whl size=53723 sha256=5bfcec1cc92cb2cb347d08c55a5a2733283000b71e708de5e21b2b203fd5a949\n","  Stored in directory: /root/.cache/pip/wheels/e1/26/51/d0bffb3d2fd82256676d7ad3003faea3bd6dddc9577af665f4\n","Successfully built sentence-transformers pypika\n","Installing collected packages: sentencepiece, pypika, monotonic, mmh3, InstructorEmbedding, bitsandbytes, websockets, uvloop, urllib3, typing-extensions, python-dotenv, PyMuPDFb, pulsar-client, overrides, opentelemetry-util-http, opentelemetry-semantic-conventions, opentelemetry-proto, mypy-extensions, marshmallow, jsonpointer, humanfriendly, httptools, h11, einops, deprecated, chroma-hnswlib, bcrypt, backoff, watchfiles, uvicorn, typing-inspect, starlette, python-liquid, pymupdf, pycares, opentelemetry-exporter-otlp-proto-common, opentelemetry-api, jsonpatch, coloredlogs, asgiref, Xformers, tiktoken, posthog, opentelemetry-sdk, opentelemetry-instrumentation, onnxruntime, langsmith, fastapi, dataclasses-json, aiohttp-retry, aiodns, opentelemetry-instrumentation-asgi, opentelemetry-exporter-otlp-proto-grpc, langchain-core, kubernetes, accelerate, opentelemetry-instrumentation-fastapi, langchain, aleph_alpha_client, sentence-transformers, chromadb\n","  Attempting uninstall: urllib3\n","    Found existing installation: urllib3 2.0.7\n","    Uninstalling urllib3-2.0.7:\n","      Successfully uninstalled urllib3-2.0.7\n","  Attempting uninstall: typing-extensions\n","    Found existing installation: typing_extensions 4.5.0\n","    Uninstalling typing_extensions-4.5.0:\n","      Successfully uninstalled typing_extensions-4.5.0\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","lida 0.0.10 requires kaleido, which is not installed.\n","lida 0.0.10 requires python-multipart, which is not installed.\n","llmx 0.0.15a0 requires cohere, which is not installed.\n","llmx 0.0.15a0 requires openai, which is not installed.\n","tensorflow-probability 0.22.0 requires typing-extensions<4.6.0, but you have typing-extensions 4.8.0 which is incompatible.\u001b[0m\u001b[31m\n","\u001b[0mSuccessfully installed InstructorEmbedding-1.0.1 PyMuPDFb-1.23.6 Xformers-0.0.22.post7 accelerate-0.24.1 aiodns-3.1.1 aiohttp-retry-2.8.3 aleph_alpha_client-4.1.0 asgiref-3.7.2 backoff-2.2.1 bcrypt-4.1.1 bitsandbytes-0.41.2.post2 chroma-hnswlib-0.7.3 chromadb-0.4.18 coloredlogs-15.0.1 dataclasses-json-0.6.3 deprecated-1.2.14 einops-0.7.0 fastapi-0.104.1 h11-0.14.0 httptools-0.6.1 humanfriendly-10.0 jsonpatch-1.33 jsonpointer-2.4 kubernetes-28.1.0 langchain-0.0.342 langchain-core-0.0.7 langsmith-0.0.67 marshmallow-3.20.1 mmh3-4.0.1 monotonic-1.6 mypy-extensions-1.0.0 onnxruntime-1.16.3 opentelemetry-api-1.21.0 opentelemetry-exporter-otlp-proto-common-1.21.0 opentelemetry-exporter-otlp-proto-grpc-1.21.0 opentelemetry-instrumentation-0.42b0 opentelemetry-instrumentation-asgi-0.42b0 opentelemetry-instrumentation-fastapi-0.42b0 opentelemetry-proto-1.21.0 opentelemetry-sdk-1.21.0 opentelemetry-semantic-conventions-0.42b0 opentelemetry-util-http-0.42b0 overrides-7.4.0 posthog-3.0.2 pulsar-client-3.3.0 pycares-4.4.0 pymupdf-1.23.6 pypika-0.48.9 python-dotenv-1.0.0 python-liquid-1.10.0 sentence-transformers-2.2.2 sentencepiece-0.1.99 starlette-0.27.0 tiktoken-0.5.1 typing-extensions-4.8.0 typing-inspect-0.9.0 urllib3-1.26.18 uvicorn-0.24.0.post1 uvloop-0.19.0 watchfiles-0.21.0 websockets-12.0\n"]}],"source":["!pip install langchain tiktoken chromadb einops transformers InstructorEmbedding accelerate bitsandbytes sentencepiece Xformers sentence-transformers pymupdf safetensors aleph_alpha_client"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"LqUlJT1KsKKz","executionInfo":{"status":"ok","timestamp":1701268843286,"user_tz":-60,"elapsed":22032,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"68580ac5-cec4-4cb5-c8af-c2675ee8efe2"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","source":["from transformers import AutoTokenizer, AutoModelForCausalLM\n","import transformers\n","from torch import cuda, bfloat16\n","\n","\n","device = f'cuda:{cuda.current_device()}' if cuda.is_available() else 'cpu'\n","\n","# set quantization configuration to load large model with less GPU memory\n","# this requires the `bitsandbytes` library\n","bnb_config = transformers.BitsAndBytesConfig(\n","    load_in_4bit=True,\n","    bnb_4bit_quant_type='nf4',\n","    bnb_4bit_use_double_quant=True, # using double quant\n","    bnb_4bit_compute_dtype=bfloat16\n",")\n","\n","\n","model_name = \"/content/drive/MyDrive/Colab Notebooks/LLMS/Llama-2-13b-chat-german\"\n","\n","model = transformers.AutoModelForCausalLM.from_pretrained(\n","    model_name,\n","    trust_remote_code=True,\n","    quantization_config=bnb_config,\n","    device_map=device\n","    )\n","model.eval()"],"metadata":{"id":"-IJs5Tvr89Rj","colab":{"base_uri":"https://localhost:8080/","height":590,"referenced_widgets":["a3d2a2fdf79a40e1a9242a3ce069f66a","37a0e1bc36f647b791f799ab0d75347b","846d1a1c29cd4b9ea965d9c22a90544b","ff3390abc1544c389baf1308346f9cd9","484bb71d1a854a8db399ddcda20cfcf7","5cd2621dec4543169dfd763e244927e1","9344a2d4a980437285205f9d33519f1d","2f7f01979d5e4136a1d8b530c2a766d2","167b76fd13c448a8a444eb4af2671edc","bd694ccfdb9246b28ad10cd020b42392","bb90f4def77748568de4e9d0839b02e8"]},"executionInfo":{"status":"ok","timestamp":1701269339226,"user_tz":-60,"elapsed":495955,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"f32249d7-665d-4349-f034-279832e2e9dc"},"execution_count":4,"outputs":[{"output_type":"display_data","data":{"text/plain":["Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a3d2a2fdf79a40e1a9242a3ce069f66a"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/transformers/generation/configuration_utils.py:381: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`. This was detected when initializing the generation config instance, which means the corresponding file may hold incorrect parameterization and should be fixed.\n","  warnings.warn(\n","/usr/local/lib/python3.10/dist-packages/transformers/generation/configuration_utils.py:386: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`. This was detected when initializing the generation config instance, which means the corresponding file may hold incorrect parameterization and should be fixed.\n","  warnings.warn(\n"]},{"output_type":"execute_result","data":{"text/plain":["LlamaForCausalLM(\n","  (model): LlamaModel(\n","    (embed_tokens): Embedding(32000, 5120, padding_idx=0)\n","    (layers): ModuleList(\n","      (0-39): 40 x LlamaDecoderLayer(\n","        (self_attn): LlamaAttention(\n","          (q_proj): Linear4bit(in_features=5120, out_features=5120, bias=False)\n","          (k_proj): Linear4bit(in_features=5120, out_features=5120, bias=False)\n","          (v_proj): Linear4bit(in_features=5120, out_features=5120, bias=False)\n","          (o_proj): Linear4bit(in_features=5120, out_features=5120, bias=False)\n","          (rotary_emb): LlamaRotaryEmbedding()\n","        )\n","        (mlp): LlamaMLP(\n","          (gate_proj): Linear4bit(in_features=5120, out_features=13824, bias=False)\n","          (up_proj): Linear4bit(in_features=5120, out_features=13824, bias=False)\n","          (down_proj): Linear4bit(in_features=13824, out_features=5120, bias=False)\n","          (act_fn): SiLUActivation()\n","        )\n","        (input_layernorm): LlamaRMSNorm()\n","        (post_attention_layernorm): LlamaRMSNorm()\n","      )\n","    )\n","    (norm): LlamaRMSNorm()\n","  )\n","  (lm_head): Linear(in_features=5120, out_features=32000, bias=False)\n",")"]},"metadata":{},"execution_count":4}]},{"cell_type":"code","source":["tokenizer = AutoTokenizer.from_pretrained(model_name)"],"metadata":{"id":"0tYDPwWMv1f4","executionInfo":{"status":"ok","timestamp":1701269341917,"user_tz":-60,"elapsed":2699,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["tokenizer.eos_token_id"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GZgHk_fpgdl3","executionInfo":{"status":"ok","timestamp":1701269341917,"user_tz":-60,"elapsed":20,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"ac7fde41-98f5-4640-ec99-d9367c56ee63"},"execution_count":6,"outputs":[{"output_type":"execute_result","data":{"text/plain":["2"]},"metadata":{},"execution_count":6}]},{"cell_type":"code","source":["from transformers import pipeline, TextStreamer\n","from langchain.llms import HuggingFacePipeline\n","import torch\n","streamer = TextStreamer(tokenizer, timeout=10., skip_prompt=True, skip_special_tokens=True)\n","\n","pipe = pipeline(\n","    \"text-generation\",\n","    model=model,\n","    tokenizer=tokenizer,\n","    # max_length=2048, should be replaced by max_new_tokens\n","    # temperature=1.0,\n","    max_new_tokens = 1024,\n","    top_p=0.95,\n","    top_k = 10,\n","    repetition_penalty=1.15,\n","    # streamer=streamer,\n","    eos_token_id=tokenizer.eos_token_id,\n","    # do_sample = True\n",")\n","\n","local_llm = HuggingFacePipeline(pipeline=pipe, model_kwargs={'temperature':0.0})"],"metadata":{"id":"p5WceJejLNgn","executionInfo":{"status":"ok","timestamp":1701269346974,"user_tz":-60,"elapsed":5075,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["from langchain.vectorstores import Chroma\n","from langchain.text_splitter import RecursiveCharacterTextSplitter\n","\n","from langchain.document_loaders import PyMuPDFLoader"],"metadata":{"id":"kYxIiryhQzaG","executionInfo":{"status":"ok","timestamp":1701269346974,"user_tz":-60,"elapsed":20,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":8,"outputs":[]},{"cell_type":"code","source":["from langchain.embeddings import HuggingFaceEmbeddings\n","\n","embeddings = HuggingFaceEmbeddings(model_name= \"setu4993/LaBSE\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":342,"referenced_widgets":["632af86211a24943bbe487d60c7020df","22bbee6a4a7b4f178b8cb87f60b14272","076288fe2f1a48b4b2d5e1ad2f080435","2200087682624d37bfdbc5d546fd5752","e025d6f6caf04df585b3c9af5df734c0","cf4449a1e42a425ea7287f51dffdc722","1f4ba60c14414887909a1d1408006a43","4a1a0c7ad8f249cc9c45060b5f2d9008","3a2d3aa5cf4049709922ab1e50d85a87","f887567d5e844384835aac8f3bf83069","c976f9ee7242497cae2e7cc6bfe24f32","c0be08a7e9c844bf85b51365a034e70a","1c579cfb01a24ce2ade11d26c2d2465b","6bd1ed4f094147b093f402f53f9dcddc","ed5e1a58b3824393bc286eccc0b13ede","52d8741fca4f427b8b849f217a9fe3de","0b317ea83ba247a79b7da496ee537983","0ed2f027cc534f2eabec204abc10ee97","0de64c98cd854324abafce1b46ce0559","dab9121562d24e6782fb62109ef7f69b","7493ee7556774eaa827ee7e995c57234","24106676ae184a0a9534ac5343f92934","d0fedd2b7a1b451f9b2b11ba786e66a8","0d6432922b844a548129cfa7b1c1f12a","56377aac9edb4e358d4d63d0050c2b26","6adc5089cdc54f379345ff2a5473db8b","c16833ad9bce4c508d05ba37ed5006da","a6520af696874526a0826b772c1f5bdb","b92fab187a5348e28c22ecf65a0ea17e","192c6bc8070248329f31b26a903c9b8f","3eb87592d45345439c8298ede1b3d3ed","5a345fc695164bf9acd1af3627c04c12","a63a4b3fe9fa4990be9710b8de874c11","0c7a74cbe30649ab9c50eaf8237d0e58","3293fba4a82d4ce89974bb61d29a77f6","a8381e8a070f420cb9822d83d35d5c29","f7bc999f244a449fabf602411ac56cf9","a2655d0985ba4386a26a46d65903e469","d052c343779346d695d0b903047be768","2da06e9da09245cf8aa886c4350e187b","a2b6339e5d544c85b4cd057d5928ed09","fa13f8533dff45ba90d1eff1543efe52","2a6ed7644c7b4decb3e40d25bfbb8db4","e589947dcbeb44b49bf63692cb119daa","4f3d60fc71b54739ac7627dbc4204193","fd74be972f454810b16b9c1ce7f2dd39","126c0355b70f402aac58a0c8ab3c187a","92ba76c92ba74cc8ab1e06e432fb60c8","c6662e45d251418687da79f900211604","11a7dd54595b47cb8779447de221e5aa","8e8a11a78d8c44ad8337faefba07223f","dd8f020bced74850b043783a1545c63c","174116a9f0b14fc8a171f3119c8dbd60","a8e2bba6e2814003848849d7c493fb95","c91d345efa264d29ab7354f4407ea240","930446ebe40b444589c9552156da0516","0854da0176644a5b81f2da8f77aa7408","90d70d9edc2d46afaa16b6107fe6b1ce","e87b2633706540d484180b3613dd8489","99ddbf021ca54acfb953f1afdcf889f1","d2ac161ffd574a7b976d40b2e7f1ef3e","3ae997381a1a4030ae11486506dd5e7c","6e6a9fa89bb4491aa6f7b03305d15557","df058edde038483aa5f2118b20a6f364","81d8fb74fd864e10b97c429b4f7f406c","63c6610ce7834164a54f4d3911826839","3398f339d3664c0287c0849d3f05f985","86565be7d8c448e3bba0dc0fbbda5702","cc9cff8caffb4c339938e7e3b05d53d1","ee459d4b83e244df97ecddaf8490475d","ab5cef6afe174abd8c6e6a06a67d7fa4","624f43d05eb44b35a3f1f49059c605b1","1c115ae123234d3d82381d0e8e441a06","6922a6c4443d496da1d3b58f8977b9db","b5677d1fa4d64e88a3b254f98ac2b3c5","f39baaedcd3846268cf0af373e813f18","cb806e6d93d742d5acddb00a802d4f15","3f355e6df02e465f91197d821ab4e809","bde588f53b044dcda317ba032bdf6f83","507b7f856a5c4b7590a7dcd6ab1cb70a","71bbe8eb74aa4f509e67c0b7a79a87ca","f1aaadde40404f6db591ad2ef846d2e4","130002a92a4e4cbe9c0bef459b37c41b","2ba8a85bb9ba4ced91f3703c1ae5ef73","23f754fe52a34897924c5099451f4343","431032b3a2b44859abff150574d06b02","b8b7b45c9a934769bf676cd3e48b6ff3","71ce7559b6e846c088383bd65bb8c07b","61c81e1435754f2c885ae1ef4467fdef","f7c41c636c5240db86b8a1a3320f1cf6","9a31ed61756d47e6a55ff2405eb43b9f","7f75ab6b11ff455c9f344e78b1682a02","2003e152909f4b34b939f4065c50ab38","e1312916cebf4cc6a9cead62a04220e5","a7e5e5b465da4540b3993edc0556f024","05c4c46236f7476a892c0505905164d2","39e907d920b543bfbcabf30ac379cc24","5f1a2f8a22334becae10c3b9165a2588","00e2fcf3c13e47d39be1780eb8477a58"]},"id":"0bGBf4TChUBq","executionInfo":{"status":"ok","timestamp":1701269528516,"user_tz":-60,"elapsed":181562,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"86499710-312a-4279-f963-756cc1d070fb"},"execution_count":9,"outputs":[{"output_type":"display_data","data":{"text/plain":[".gitattributes:   0%|          | 0.00/496 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"632af86211a24943bbe487d60c7020df"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["README.md:   0%|          | 0.00/4.41k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c0be08a7e9c844bf85b51365a034e70a"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/611 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d0fedd2b7a1b451f9b2b11ba786e66a8"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["model.safetensors:   0%|          | 0.00/1.88G [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0c7a74cbe30649ab9c50eaf8237d0e58"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["pytorch_model.bin:   0%|          | 0.00/1.88G [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"4f3d60fc71b54739ac7627dbc4204193"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["special_tokens_map.json:   0%|          | 0.00/125 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"930446ebe40b444589c9552156da0516"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["tokenizer.json:   0%|          | 0.00/13.6M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3398f339d3664c0287c0849d3f05f985"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["tokenizer_config.json:   0%|          | 0.00/367 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3f355e6df02e465f91197d821ab4e809"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["vocab.txt:   0%|          | 0.00/5.22M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"61c81e1435754f2c885ae1ef4467fdef"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["WARNING:sentence_transformers.SentenceTransformer:No sentence-transformers model found with name /root/.cache/torch/sentence_transformers/setu4993_LaBSE. Creating a new one with MEAN pooling.\n"]}]},{"cell_type":"markdown","source":["# Loading data and Splitting"],"metadata":{"id":"jxUrrRCHu6Fk"}},{"cell_type":"code","source":["loader = PyMuPDFLoader('/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf')"],"metadata":{"id":"iMqqorzcR7ci","executionInfo":{"status":"ok","timestamp":1701264148106,"user_tz":-60,"elapsed":379,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":37,"outputs":[]},{"cell_type":"code","source":["documents = loader.load_and_split() # single document"],"metadata":{"id":"uHuVOOPCQz02","executionInfo":{"status":"ok","timestamp":1701264150108,"user_tz":-60,"elapsed":390,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":38,"outputs":[]},{"cell_type":"code","source":["documents[1].page_content"],"metadata":{"id":"XNdPgblVFyac","colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"status":"ok","timestamp":1701264151140,"user_tz":-60,"elapsed":16,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"4602f61f-2765-4e2a-91a6-4bc775b8b9f8"},"execution_count":39,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'7\\nDE\\n•�Versuchen�Sie�niemals,�die�Waschmaschinentür�mit�Gewalt�zu�öffnen.�Die�Wasch-\\nmaschinentür lässt sich erst ein paar Minuten nach dem Ende des Waschpro-\\ngramms öffnen. Falls Sie versuchen, die Tür gewaltsam zu öffnen, können Tür und \\nVerriegelungsmechanismus beschädigt werden.\\n•�Ziehen�Sie�den�Netzstecker,�wenn�Sie�das�Gerät�nicht�benutzen.\\n•�Gießen�Sie�niemals�Wasser�oder�andere�Flüssigkeiten�direkt�auf�das�Gerät!�Es�\\nbesteht Stromschlaggefahr!\\n•�Berühren�Sie�den�Stecker�niemals�mit�feuchten�oder�gar�nassen�Händen!�Ziehen�\\nSie den Netzstecker niemals am Kabel aus der Steckdose: Fassen Sie grundsätz-\\nlich den Stecker selbst.\\n•�Verwenden� Sie� ausschließlich� für� Waschmaschinen� geeignete� Waschmittel,�\\nWeichspüler und Zusatzstoffe.\\n•�Halten�Sie�sich�an�die�Hinweise�auf�Pflegeetiketten�und�auf�der�Waschmittelpa-\\nckung.\\n•�Vor�Aufstellung,�Wartung,�Reinigung�und�vor�Reparaturen�muss�unbedingt�der�\\nNetzstecker gezogen werden.\\n•�Lassen�Sie�Installations-�und�Reparaturarbeiten�grundsätzlich�vom�autorisier-\\nten Kundendienst ausführen. Der Hersteller haftet nicht bei Schäden, die \\ndurch den Eingriff nicht autorisierter Personen entstehen.\\n•�Falls�das�Netzkabel�beschädigt�wird,�muss�es�vom�Hersteller,�seinem�Kunden-\\ndienst, einer vom Importeur bestimmten Stelle oder einer gleichermaßen qualifi-\\nzierten Person (am besten einem Elektriker) ausgetauscht werden. \\n•�Stellen�Sie�das�Produkt�auf�einen�festen,�flachen�und�ebenen�Untergrund.\\n•�Stellen�Sie�das�Gerät�nicht�auf�langflorigen�Teppichen�oder�ähnlichen�Unterlagen�\\nauf.\\n•�Stellen�Sie�das�Produkt�nicht�auf�eine�hohe�Plattform�oder�in�die�Nähe�der�Kante�\\neines kaskadierten Untergrundes.\\n•�Stellen�Sie�das�Gerät�nicht�auf�das�Netzkabel.\\n•�Benutzen�Sie�niemals�Scheuerschwämme�oder�andere�Scheuermittel.�Solche�Mit-\\nte beschädigen lackierte und verchromte Flächen sowie Kunststoffteile.\\n1.2 Bestimmungsgemäßer Einsatz\\n•�Dieses�Gerät�wurde�für�den�Hausgebrauch�entwickelt.�Es�darf�nicht�für�kommer-\\nzielle Zwecke und nicht außerhalb seines bestimmungsgemäßen Einsatzgebietes \\neingesetzt werden.\\n•�Das�Gerät�darf�nur�zum�Waschen�und�Spülen�von�Textilien�verwendet�werden,�die�\\nentsprechend gekennzeichnet sind.\\n•�Der�Hersteller�haftet�nicht�bei�Schäden,�die�durch�falschen�Gebrauch�oder�un-\\nsachgemäßen Transport entstehen.'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":39}]},{"cell_type":"code","source":["#splitting the text into\n","text_splitter = RecursiveCharacterTextSplitter(chunk_size=500, chunk_overlap=50)\n","texts = text_splitter.split_documents(documents)"],"metadata":{"id":"SW1hiEVRR173","executionInfo":{"status":"ok","timestamp":1701264153346,"user_tz":-60,"elapsed":397,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":40,"outputs":[]},{"cell_type":"code","source":["len(texts)"],"metadata":{"id":"kjFfrqp-Hzo4","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701264155121,"user_tz":-60,"elapsed":500,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"043e4f1b-199a-456f-c080-5488ddadfad5"},"execution_count":41,"outputs":[{"output_type":"execute_result","data":{"text/plain":["213"]},"metadata":{},"execution_count":41}]},{"cell_type":"code","source":["\n","# from langchain.embeddings import HuggingFaceInstructEmbeddings\n","\n","# instructor_embeddings = HuggingFaceInstructEmbeddings(model_name=\"hkunlp/instructor-xl\",\n","#                                                       model_kwargs={\"device\": \"cuda\"})\n"],"metadata":{"id":"Hbnp8UgeSTI1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Embed and store the texts\n","# Supplying a persist_directory will store the embeddings on disk\n","persist_directory = \"/content/drive/MyDrive/Colab Notebooks/manual\"\n","# persist_directory = \"db\"\n","\n","## Here is the nmew embeddings being used\n","# embedding = instructor_embeddings\n","\n","vectordb = Chroma.from_documents(documents=texts, collection_name=\"manual-truncated-labse\",\n","                                 embedding=embeddings,\n","                                 persist_directory=persist_directory)\n","\n","# must be run when using in notebook otherwise db will not persist automatically\n","vectordb.persist()"],"metadata":{"id":"XYSO_xfzSYML","executionInfo":{"status":"ok","timestamp":1701264159561,"user_tz":-60,"elapsed":1200,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":42,"outputs":[]},{"cell_type":"markdown","source":["Load already stored documents"],"metadata":{"id":"hHG0Yd58DR_o"}},{"cell_type":"markdown","source":["# Load alreday stored data from drive"],"metadata":{"id":"mO7Nc9wgvQQU"}},{"cell_type":"code","source":["persist_directory = \"/content/drive/MyDrive/Colab Notebooks/manual\""],"metadata":{"id":"tm_Ml0XtSW8y","executionInfo":{"status":"ok","timestamp":1701270082144,"user_tz":-60,"elapsed":504,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":10,"outputs":[]},{"cell_type":"code","source":["vectordb = Chroma(embedding_function=embeddings, collection_name=\"manual-truncated-labse\",\n","                                 persist_directory=persist_directory)"],"metadata":{"id":"mUqNr2zsZNkI","executionInfo":{"status":"ok","timestamp":1701270096519,"user_tz":-60,"elapsed":1979,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":11,"outputs":[]},{"cell_type":"markdown","source":["### Check to see if collection is overridden. if so delete it and recreate by running previous steps"],"metadata":{"id":"H1uodZ95P4iY"}},{"cell_type":"code","source":["# import chromadb\n","# client = chromadb.PersistentClient(path=persist_directory)"],"metadata":{"id":"0UPgsW0QOVmM","executionInfo":{"status":"ok","timestamp":1701264171643,"user_tz":-60,"elapsed":427,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":44,"outputs":[]},{"cell_type":"code","source":["# collection = client.get_collection(name=\"manual-truncated-labse\")"],"metadata":{"id":"EXD_Hyw_Oqrb","executionInfo":{"status":"ok","timestamp":1701264173624,"user_tz":-60,"elapsed":400,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":45,"outputs":[]},{"cell_type":"code","source":["# client.delete_collection(name=\"manual-truncated-labse\")"],"metadata":{"id":"LnDbDiNEPeZS","executionInfo":{"status":"ok","timestamp":1701264122251,"user_tz":-60,"elapsed":369,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":35,"outputs":[]},{"cell_type":"code","source":["# collection.count()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"b0xDTP4oPO4n","executionInfo":{"status":"ok","timestamp":1701264192438,"user_tz":-60,"elapsed":371,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"524f1ffe-a7db-4131-dbc9-2f3f0e0c998d"},"execution_count":48,"outputs":[{"output_type":"execute_result","data":{"text/plain":["213"]},"metadata":{},"execution_count":48}]},{"cell_type":"code","source":["vectordb.similarity_search(\"what is the document about?\")"],"metadata":{"id":"13dy5kIfFTfY","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701266393569,"user_tz":-60,"elapsed":4787,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"ca860c46-efe8-48a3-8500-2d2fa6eddf73"},"execution_count":12,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[Document(page_content='die Start-/Pause-/Abbrechen-Taste.\\nDas Programm wird fortgesetzt. Das Wasser \\nwird abgepumpt, die Wäsche geschleudert, das \\nProgramm abgeschlossen.', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 20, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}),\n"," Document(page_content='der Schleudergeschwindigkeit sowie Schwankungen der Versorgungsspannung ändern.\\nC \\nDie Dauer des ausgewählten Programms erscheint im Display der Maschine. Dabei kann es \\ndurchaus zu kleinen Abweichungen zwischen der angezeigten und der tatsächlichen Dauer kommen.\\nRichtwerte für Synthetik-Programme (DE)\\n Beladung (kg) \\nWasserverbrauch \\n(l)\\nEnergieverbrauch \\n(kWh)\\nProgrammdauer \\n(Min)*\\nRestfeuchtigkeit (%) **\\nRestfeuchtigkeit (%) **\\n≤ 1000 rpm\\n> 1000 rpm\\nPflegeleicht 60\\n3\\n45\\n1.00\\n01:48\\n45\\n40', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 19, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}),\n"," Document(page_content='Waschen richtig behandelt werden. Fragen Sie \\nim Zweifelsfall bei einer chemischen Reinigung \\nnach.\\n•�Verwenden�Sie�ausschließlich�Färbemittel�oder�\\nMittel zur Kalkentfernung, die sich ausdrücklich \\nzur Verwendung in der Waschmaschine eignen. \\nBeachten Sie dabei immer die Hinweise auf der \\nVerpackung.\\n•�Waschen�Sie�Hosen�und�empfindliche�\\nKleidungsstücke „auf links“, also mit der \\nInnenseite nach außen.\\n•�Legen�Sie�Wäschestücke�aus�Angorawolle�\\nvor dem Waschen ein paar Stunden in das', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 9, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}),\n"," Document(page_content='wieder an den alten Platz und ziehen Sie die \\nMuttern an den Schläuchen von Hand an.\\nRestliches Wasser ablaufen lassen \\nund Pumpenfilter reinigen\\nDie Filtersysteme in Ihrer Maschine sorgen dafür, \\ndass Festkörper wie Knöpfe, Münzen und Textilfasern \\nausgefiltert werden und den Propeller der Pumpe \\nbeim Ablaufen des Wassers nicht zusetzen können. \\nSo wird die Pumpe beim Abpumpen des Wassers \\nweniger stark belastet und hält länger.\\nFalls das Wasser nicht mehr vollständig aus Ihrer', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 26, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''})]"]},"metadata":{},"execution_count":12}]},{"cell_type":"code","source":["import textwrap\n","from collections import defaultdict\n","\n","def wrap_text_preserve_newlines(text, width=110):\n","    # Split the input text into lines based on newline characters\n","    lines = text.split('\\n')\n","\n","    # Wrap each line individually\n","    wrapped_lines = [textwrap.fill(line, width=width) for line in lines]\n","\n","    # Join the wrapped lines back together using newline characters\n","    wrapped_text = '\\n'.join(wrapped_lines)\n","\n","    return wrapped_text\n","\n","def process_llm_response(llm_response):\n","    answer = wrap_text_preserve_newlines(llm_response['answer'])\n","    print(answer)\n","    print('\\n\\nSources:')\n","    sources = defaultdict(list)\n","    for source in llm_response[\"source_documents\"]:\n","        source_document = source.metadata['source']\n","        source_page = source.metadata['page']\n","        sources[source_document].append(source_page)\n","        print(source_document, source_page)\n","    return answer, sources"],"metadata":{"id":"wiL6-LOhXGt0","executionInfo":{"status":"ok","timestamp":1701270217499,"user_tz":-60,"elapsed":696,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":23,"outputs":[]},{"cell_type":"markdown","source":["# Langchain ConversationalRetrievalChain"],"metadata":{"id":"lKUXzGJgwDpn"}},{"cell_type":"code","source":["from langchain.chains import ConversationalRetrievalChain\n","from langchain.memory import VectorStoreRetrieverMemory"],"metadata":{"id":"ScoM6HAxgCMq","executionInfo":{"status":"ok","timestamp":1701270102134,"user_tz":-60,"elapsed":1356,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":12,"outputs":[]},{"cell_type":"markdown","source":["# With llama2 default prompt.\n","You are a helpful, respectful and honest assistant. Always answer as helpfully as possible, while being safe. Your answers should not include any harmful, unethical, racist, sexist, toxic, dangerous, or illegal content. Please ensure that your responses are socially unbiased and positive in nature.\n","\n","If a question does not make any sense, or is not factually coherent, explain why instead of answering something not correct. If you don't know the answer to a question, please don't share false information.\"\"\"\n"],"metadata":{"id":"1sflOWt2h7QE"}},{"cell_type":"code","source":["## Default LLaMA-2 prompt style\n","B_INST, E_INST = \"[INST]\", \"[/INST]\"\n","B_SYS, E_SYS = \"<<SYS>>\\n\", \"\\n<</SYS>>\\n\\n\"\n","context = \"CONTEXT:/n/n {context}/n\"\n","DEFAULT_SYSTEM_PROMPT = \"\"\"\\\n","You are a helpful, respectful and honest assistant. Always answer as helpfully as possible, while being safe. Your answers should not include any harmful, unethical, racist, sexist, toxic, dangerous, or illegal content. Please ensure that your responses are socially unbiased and positive in nature.\n","\n","If a question does not make any sense, or is not factually coherent, explain why instead of answering something not correct. If you don't know the answer to a question, please don't share false information.\n","\n","\"\"\"\n","\n","def get_prompt(instruction, new_system_prompt=DEFAULT_SYSTEM_PROMPT ):\n","    SYSTEM_PROMPT = B_SYS + new_system_prompt + E_SYS\n","    prompt_template =  B_INST + SYSTEM_PROMPT + instruction + E_INST\n","    return prompt_template\n","\n","# def get_prompt(instruction, new_system_prompt=DEFAULT_SYSTEM_PROMPT ):\n","#     SYSTEM_PROMPT = B_INST + B_SYS + new_system_prompt + context + E_SYS\n","#     question_prompt =  instruction + E_INST\n","#     return SYSTEM_PROMPT, question_prompt"],"metadata":{"id":"hc907DAsiL1D","executionInfo":{"status":"ok","timestamp":1701270106034,"user_tz":-60,"elapsed":440,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":13,"outputs":[]},{"cell_type":"code","source":["sys_prompt = \"\"\"You are a helpful, respectful and honest assistant. Always answer as helpfully as possible using the context text provided. Your answers should only answer the question once and not have any text after the answer is done.\n","\n","If a question does not make any sense, or is not factually coherent, explain why instead of answering something not correct. If you don't know the answer to a question, please don't share false information. \"\"\"\n","\n","instruction = \"\"\"CONTEXT:/n/n {context}/n\n","\n","Question: {question}\"\"\"\n","prompt_template = get_prompt(instruction, sys_prompt)"],"metadata":{"id":"4B3K0HDeyxDj","executionInfo":{"status":"ok","timestamp":1701270110484,"user_tz":-60,"elapsed":16,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":14,"outputs":[]},{"cell_type":"code","source":["from langchain.prompts.prompt import PromptTemplate\n","\n","A_PROMPT = PromptTemplate(\n","    template=prompt_template, input_variables=[\"context\", \"question\"]\n",")\n"],"metadata":{"id":"P8M3SHMTynNA","executionInfo":{"status":"ok","timestamp":1701270110485,"user_tz":-60,"elapsed":13,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":15,"outputs":[]},{"cell_type":"code","source":["A_PROMPT"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vELo8CSUzVL6","executionInfo":{"status":"ok","timestamp":1701270111402,"user_tz":-60,"elapsed":9,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"25588910-7c25-4b66-b5ac-5c5f58d09d4b"},"execution_count":16,"outputs":[{"output_type":"execute_result","data":{"text/plain":["PromptTemplate(input_variables=['context', 'question'], template=\"[INST]<<SYS>>\\nYou are a helpful, respectful and honest assistant. Always answer as helpfully as possible using the context text provided. Your answers should only answer the question once and not have any text after the answer is done.\\n\\nIf a question does not make any sense, or is not factually coherent, explain why instead of answering something not correct. If you don't know the answer to a question, please don't share false information. \\n<</SYS>>\\n\\nCONTEXT:/n/n {context}/n\\n\\nQuestion: {question}[/INST]\")"]},"metadata":{},"execution_count":16}]},{"cell_type":"code","source":["# Needs a seperate vectordb instance to avoid any duplication between history and the document embeddings itself\n","vectorstore = Chroma(embedding_function=embeddings, collection_name=\"manual-truncated-labse-history\",\n","                                 persist_directory=persist_directory)"],"metadata":{"id":"FrFpo1M-CHeV","executionInfo":{"status":"ok","timestamp":1701270126740,"user_tz":-60,"elapsed":920,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":18,"outputs":[]},{"cell_type":"code","source":["# use vectorstore as a memory retriver. most relavent memory messages are used\n","retriever = vectorstore.as_retriever(search_kwargs=dict(k=3), search_type=\"mmr\")\n","memory = VectorStoreRetrieverMemory(retriever=retriever, memory_key=\"chat_history\", return_messages=True, return_docs=False, output_key='answer')"],"metadata":{"id":"DUF6E_xjNRGP","executionInfo":{"status":"ok","timestamp":1701270132783,"user_tz":-60,"elapsed":549,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":19,"outputs":[]},{"cell_type":"code","source":["pdf_qa = ConversationalRetrievalChain.from_llm(local_llm , vectordb.as_retriever(search_type=\"mmr\"),\n","                                               memory=memory, return_source_documents=True, get_chat_history=lambda h :h, combine_docs_chain_kwargs={\"prompt\": A_PROMPT})"],"metadata":{"id":"bpTaH7nni15h","executionInfo":{"status":"ok","timestamp":1701270135143,"user_tz":-60,"elapsed":465,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":20,"outputs":[]},{"cell_type":"code","source":["vectordb.similarity_search(\"what is the document about?\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"AZz-kl75apPX","executionInfo":{"status":"ok","timestamp":1701270120815,"user_tz":-60,"elapsed":6188,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"d8f4828a-9f6c-4867-91ef-37dfb3a2072b"},"execution_count":17,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[Document(page_content='der Schleudergeschwindigkeit sowie Schwankungen der Versorgungsspannung ändern.\\nC \\nDie Dauer des ausgewählten Programms erscheint im Display der Maschine. Dabei kann es \\ndurchaus zu kleinen Abweichungen zwischen der angezeigten und der tatsächlichen Dauer kommen.\\nRichtwerte für Synthetik-Programme (DE)\\n Beladung (kg) \\nWasserverbrauch \\n(l)\\nEnergieverbrauch \\n(kWh)\\nProgrammdauer \\n(Min)*\\nRestfeuchtigkeit (%) **\\nRestfeuchtigkeit (%) **\\n≤ 1000 rpm\\n> 1000 rpm\\nPflegeleicht 60\\n3\\n45\\n1.00\\n01:48\\n45\\n40', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 19, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}),\n"," Document(page_content='Waschen richtig behandelt werden. Fragen Sie \\nim Zweifelsfall bei einer chemischen Reinigung \\nnach.\\n•�Verwenden�Sie�ausschließlich�Färbemittel�oder�\\nMittel zur Kalkentfernung, die sich ausdrücklich \\nzur Verwendung in der Waschmaschine eignen. \\nBeachten Sie dabei immer die Hinweise auf der \\nVerpackung.\\n•�Waschen�Sie�Hosen�und�empfindliche�\\nKleidungsstücke „auf links“, also mit der \\nInnenseite nach außen.\\n•�Legen�Sie�Wäschestücke�aus�Angorawolle�\\nvor dem Waschen ein paar Stunden in das', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 9, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}),\n"," Document(page_content='> 1000 rpm\\nPflegeleicht 60\\n3\\n45\\n1.00\\n01:48\\n45\\n40\\nPflegeleicht 40\\n3\\n45\\n0.45\\n01:23\\n45\\n40\\n* Die Dauer des ausgewählten Programms erscheint im Display der Maschine. Dabei kann es durchaus zu kleinen \\nAbweichungen zwischen der angezeigten und der tatsächlichen Dauer kommen.\\n** Die Restfeuchtigkeit hängt von der gewählten Schleudergeschwindigkeit ab.', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 19, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}),\n"," Document(page_content='Programme zur Verfügung.\\nC \\nZusatzprogramme können je nach Modell \\nIhrer Maschine abweichen.\\n• Buntwäsche Eco\\nMit diesem Programm waschen Sie normal \\nverschmutzte, strapazierfähige Baumwoll- und \\nLeinenwäsche. Dabei sparen Sie im Vergleich zu \\nanderen Baumwollprogrammen eine Menge Wasser \\nund Energie. Die tatsächliche Wassertemperatur \\nkann etwas von der regulären Programmtemperatur \\nabweichen. Die Programmdauer verkürzt sich im \\nVerlauf des Programms automatisch, wenn Sie', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 15, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''})]"]},"metadata":{},"execution_count":17}]},{"cell_type":"code","source":["import gc\n","import torch\n","# to flush the pytorch memory manually\n","def flush():\n","  gc.collect()\n","  torch.cuda.empty_cache()\n","  torch.cuda.reset_peak_memory_stats()"],"metadata":{"id":"aCYBzwFIazFe","executionInfo":{"status":"ok","timestamp":1701270142863,"user_tz":-60,"elapsed":1525,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}}},"execution_count":21,"outputs":[]},{"cell_type":"code","source":["import pandas as pd\n","\n","# iterating through all queries and storing the results in csv/excel for evaluation\n","questions_list = [\"what is the document about?\",\n","                  \"Was muss ich beim Filter beachten?\",\n","                  \"Welche Schäden können an der Waschmaschine im Betrieb entstehen?\",\n","                  \"Wo finde ich Sammelstellen für Altgeräte?\",\n","                  \"Welche Gefahren habe ich mit dieser Waschmaschine?\",\n","                  \"Wo kann ich Waschmittel in die Waschmaschine einfüllen?\",\n","                  \"Was muss ich bei der Aufstellung der Waschmaschine beachten?\",\n","                  \"Kann man das Wasser des Schlauchs trinken?\",\n","                  \"Kann ich die Maschinentür öffnen, wenn Wasser in der Maschine sichtbar ist?\",\n","                  \"Wie kann ich den Weichspüler in der Maschine verwenden?\",\n","                  \"Welche Temperatur wird für bunte und stark verschmutzte Wäsche empfohlen?\",\n","                  \"Wie lauten die Anweisungen für helle Farben und extrem verschmutzte Wäsche?\",\n","                  \"Wie bereite ich die Wäsche zum Waschen vor?\",\n","                  \"Wie kann man Wäsche sortieren?\",\n","                  \"Wie lauten die Anweisungen für den Anschluss des Wasserablaufs?\",\n","                  \"Welche Gefahren habe ich mit dieser Waschmaschine?\",\n","                  \"Kann ich mit dem Wasser aus der Waschmaschine meine Katze waschen?\"\n","                  ]\n","results = defaultdict(list)\n","for query in questions_list:\n","  response = pdf_qa({\"question\": query})\n","  answer, sources = process_llm_response(response)\n","  results[\"question\"].append(query)\n","  results[\"answer\"].append(answer)\n","  results[\"memory\"].append(memory.load_memory_variables({\"prompt\": query})[\"chat_history\"])\n","  results[\"sources\"].append(sources)\n","  flush()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":636},"id":"ziGs6XXGup2N","executionInfo":{"status":"error","timestamp":1701270230841,"user_tz":-60,"elapsed":6853,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"ce5d4401-2a94-4c43-80c1-78c89431d0c1"},"execution_count":24,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:chromadb.segment.impl.vector.local_persistent_hnsw:Number of requested results 20 is greater than number of elements in index 2, updating n_results = 2\n","/usr/local/lib/python3.10/dist-packages/transformers/generation/utils.py:1473: UserWarning: You have modified the pretrained model configuration to control generation. This is a deprecated strategy to control generation and will be removed soon, in a future version. Please use and modify the model generation configuration (see https://huggingface.co/docs/transformers/generation_strategies#default-text-generation-configuration )\n","  warnings.warn(\n","/usr/local/lib/python3.10/dist-packages/transformers/generation/configuration_utils.py:386: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.\n","  warnings.warn(\n","/usr/local/lib/python3.10/dist-packages/transformers/generation/configuration_utils.py:396: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `10` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.\n","  warnings.warn(\n"]},{"output_type":"error","ename":"OutOfMemoryError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mOutOfMemoryError\u001b[0m                          Traceback (most recent call last)","\u001b[0;32m<ipython-input-24-2cd684c2be5d>\u001b[0m in \u001b[0;36m<cell line: 23>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     22\u001b[0m \u001b[0mresults\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdefaultdict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlist\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     23\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mquery\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mquestions_list\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 24\u001b[0;31m   \u001b[0mresponse\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mpdf_qa\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m{\u001b[0m\u001b[0;34m\"question\"\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mquery\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     25\u001b[0m   \u001b[0manswer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msources\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mprocess_llm_response\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mresponse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     26\u001b[0m   \u001b[0mresults\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"question\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mquery\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain/chains/base.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, inputs, return_only_outputs, callbacks, tags, metadata, run_name, include_run_info)\u001b[0m\n\u001b[1;32m    310\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mBaseException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    311\u001b[0m             \u001b[0mrun_manager\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_chain_error\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0me\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 312\u001b[0;31m             \u001b[0;32mraise\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    313\u001b[0m         \u001b[0mrun_manager\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_chain_end\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moutputs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    314\u001b[0m         final_outputs: Dict[str, Any] = self.prep_outputs(\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain/chains/base.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, inputs, return_only_outputs, callbacks, tags, metadata, run_name, include_run_info)\u001b[0m\n\u001b[1;32m    304\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    305\u001b[0m             outputs = (\n\u001b[0;32m--> 306\u001b[0;31m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minputs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrun_manager\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mrun_manager\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    307\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0mnew_arg_supported\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    308\u001b[0m                 \u001b[0;32melse\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minputs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain/chains/conversational_retrieval/base.py\u001b[0m in \u001b[0;36m_call\u001b[0;34m(self, inputs, run_manager)\u001b[0m\n\u001b[1;32m    140\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mchat_history_str\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    141\u001b[0m             \u001b[0mcallbacks\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_run_manager\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_child\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 142\u001b[0;31m             new_question = self.question_generator.run(\n\u001b[0m\u001b[1;32m    143\u001b[0m                 \u001b[0mquestion\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mquestion\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mchat_history\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mchat_history_str\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcallbacks\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcallbacks\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    144\u001b[0m             )\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain/chains/base.py\u001b[0m in \u001b[0;36mrun\u001b[0;34m(self, callbacks, tags, metadata, *args, **kwargs)\u001b[0m\n\u001b[1;32m    510\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    511\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mkwargs\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0margs\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 512\u001b[0;31m             return self(kwargs, callbacks=callbacks, tags=tags, metadata=metadata)[\n\u001b[0m\u001b[1;32m    513\u001b[0m                 \u001b[0m_output_key\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    514\u001b[0m             ]\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain/chains/base.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, inputs, return_only_outputs, callbacks, tags, metadata, run_name, include_run_info)\u001b[0m\n\u001b[1;32m    310\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mBaseException\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    311\u001b[0m             \u001b[0mrun_manager\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_chain_error\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0me\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 312\u001b[0;31m             \u001b[0;32mraise\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    313\u001b[0m         \u001b[0mrun_manager\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_chain_end\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moutputs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    314\u001b[0m         final_outputs: Dict[str, Any] = self.prep_outputs(\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain/chains/base.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, inputs, return_only_outputs, callbacks, tags, metadata, run_name, include_run_info)\u001b[0m\n\u001b[1;32m    304\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    305\u001b[0m             outputs = (\n\u001b[0;32m--> 306\u001b[0;31m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minputs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrun_manager\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mrun_manager\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    307\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0mnew_arg_supported\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    308\u001b[0m                 \u001b[0;32melse\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minputs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain/chains/llm.py\u001b[0m in \u001b[0;36m_call\u001b[0;34m(self, inputs, run_manager)\u001b[0m\n\u001b[1;32m    101\u001b[0m         \u001b[0mrun_manager\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mOptional\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mCallbackManagerForChainRun\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    102\u001b[0m     ) -> Dict[str, str]:\n\u001b[0;32m--> 103\u001b[0;31m         \u001b[0mresponse\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgenerate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0minputs\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrun_manager\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mrun_manager\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    104\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcreate_outputs\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mresponse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    105\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain/chains/llm.py\u001b[0m in \u001b[0;36mgenerate\u001b[0;34m(self, input_list, run_manager)\u001b[0m\n\u001b[1;32m    113\u001b[0m         \u001b[0mcallbacks\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mrun_manager\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_child\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mrun_manager\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    114\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mllm\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mBaseLanguageModel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 115\u001b[0;31m             return self.llm.generate_prompt(\n\u001b[0m\u001b[1;32m    116\u001b[0m                 \u001b[0mprompts\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    117\u001b[0m                 \u001b[0mstop\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain_core/language_models/llms.py\u001b[0m in \u001b[0;36mgenerate_prompt\u001b[0;34m(self, prompts, stop, callbacks, **kwargs)\u001b[0m\n\u001b[1;32m    504\u001b[0m     ) -> LLMResult:\n\u001b[1;32m    505\u001b[0m         \u001b[0mprompt_strings\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mto_string\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mp\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mprompts\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 506\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgenerate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mprompt_strings\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstop\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mstop\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcallbacks\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mcallbacks\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    507\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    508\u001b[0m     async def agenerate_prompt(\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain_core/language_models/llms.py\u001b[0m in \u001b[0;36mgenerate\u001b[0;34m(self, prompts, stop, callbacks, tags, metadata, run_name, **kwargs)\u001b[0m\n\u001b[1;32m    654\u001b[0m                 )\n\u001b[1;32m    655\u001b[0m             ]\n\u001b[0;32m--> 656\u001b[0;31m             output = self._generate_helper(\n\u001b[0m\u001b[1;32m    657\u001b[0m                 \u001b[0mprompts\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstop\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrun_managers\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbool\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnew_arg_supported\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    658\u001b[0m             )\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain_core/language_models/llms.py\u001b[0m in \u001b[0;36m_generate_helper\u001b[0;34m(self, prompts, stop, run_managers, new_arg_supported, **kwargs)\u001b[0m\n\u001b[1;32m    541\u001b[0m             \u001b[0;32mfor\u001b[0m \u001b[0mrun_manager\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mrun_managers\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    542\u001b[0m                 \u001b[0mrun_manager\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_llm_error\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0me\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 543\u001b[0;31m             \u001b[0;32mraise\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    544\u001b[0m         \u001b[0mflattened_outputs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0moutput\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflatten\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    545\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mmanager\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mflattened_output\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mzip\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrun_managers\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mflattened_outputs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain_core/language_models/llms.py\u001b[0m in \u001b[0;36m_generate_helper\u001b[0;34m(self, prompts, stop, run_managers, new_arg_supported, **kwargs)\u001b[0m\n\u001b[1;32m    528\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    529\u001b[0m             output = (\n\u001b[0;32m--> 530\u001b[0;31m                 self._generate(\n\u001b[0m\u001b[1;32m    531\u001b[0m                     \u001b[0mprompts\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    532\u001b[0m                     \u001b[0mstop\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mstop\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/langchain/llms/huggingface_pipeline.py\u001b[0m in \u001b[0;36m_generate\u001b[0;34m(self, prompts, stop, run_manager, **kwargs)\u001b[0m\n\u001b[1;32m    201\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    202\u001b[0m             \u001b[0;31m# Process batch of prompts\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 203\u001b[0;31m             \u001b[0mresponses\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpipeline\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mbatch_prompts\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    204\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    205\u001b[0m             \u001b[0;31m# Process each response in the batch\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/pipelines/text_generation.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, text_inputs, **kwargs)\u001b[0m\n\u001b[1;32m    206\u001b[0m               \u001b[0mids\u001b[0m \u001b[0mof\u001b[0m \u001b[0mthe\u001b[0m \u001b[0mgenerated\u001b[0m \u001b[0mtext\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    207\u001b[0m         \"\"\"\n\u001b[0;32m--> 208\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0msuper\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__call__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtext_inputs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    209\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    210\u001b[0m     def preprocess(\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/pipelines/base.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, inputs, num_workers, batch_size, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1119\u001b[0m                     \u001b[0minputs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnum_workers\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbatch_size\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mpreprocess_params\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mforward_params\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mpostprocess_params\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1120\u001b[0m                 )\n\u001b[0;32m-> 1121\u001b[0;31m                 \u001b[0moutputs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlist\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfinal_iterator\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1122\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0moutputs\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1123\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/pipelines/pt_utils.py\u001b[0m in \u001b[0;36m__next__\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    122\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    123\u001b[0m         \u001b[0;31m# We're out of items within a batch\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 124\u001b[0;31m         \u001b[0mitem\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnext\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0miterator\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    125\u001b[0m         \u001b[0mprocessed\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0minfer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mitem\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mparams\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    126\u001b[0m         \u001b[0;31m# We now have a batch of \"inferred things\".\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/pipelines/pt_utils.py\u001b[0m in \u001b[0;36m__next__\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    123\u001b[0m         \u001b[0;31m# We're out of items within a batch\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    124\u001b[0m         \u001b[0mitem\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnext\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0miterator\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 125\u001b[0;31m         \u001b[0mprocessed\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0minfer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mitem\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mparams\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    126\u001b[0m         \u001b[0;31m# We now have a batch of \"inferred things\".\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    127\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mloader_batch_size\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/pipelines/base.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, model_inputs, **forward_params)\u001b[0m\n\u001b[1;32m   1044\u001b[0m                 \u001b[0;32mwith\u001b[0m \u001b[0minference_context\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1045\u001b[0m                     \u001b[0mmodel_inputs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_ensure_tensor_on_device\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel_inputs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdevice\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdevice\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1046\u001b[0;31m                     \u001b[0mmodel_outputs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel_inputs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mforward_params\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1047\u001b[0m                     \u001b[0mmodel_outputs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_ensure_tensor_on_device\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel_outputs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdevice\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdevice\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"cpu\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1048\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/pipelines/text_generation.py\u001b[0m in \u001b[0;36m_forward\u001b[0;34m(self, model_inputs, **generate_kwargs)\u001b[0m\n\u001b[1;32m    269\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    270\u001b[0m         \u001b[0;31m# BS x SL\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 271\u001b[0;31m         \u001b[0mgenerated_sequence\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgenerate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minput_ids\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0minput_ids\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mattention_mask\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mattention_mask\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mgenerate_kwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    272\u001b[0m         \u001b[0mout_b\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mgenerated_sequence\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    273\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mframework\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m\"pt\"\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py\u001b[0m in \u001b[0;36mdecorate_context\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    113\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mdecorate_context\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    114\u001b[0m         \u001b[0;32mwith\u001b[0m \u001b[0mctx_factory\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 115\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    116\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    117\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mdecorate_context\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/generation/utils.py\u001b[0m in \u001b[0;36mgenerate\u001b[0;34m(self, inputs, generation_config, logits_processor, stopping_criteria, prefix_allowed_tokens_fn, synced_gpus, assistant_model, streamer, negative_prompt_ids, negative_prompt_attention_mask, **kwargs)\u001b[0m\n\u001b[1;32m   1671\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mgeneration_mode\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0mGenerationMode\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mGREEDY_SEARCH\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1672\u001b[0m             \u001b[0;31m# 11. run greedy search\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1673\u001b[0;31m             return self.greedy_search(\n\u001b[0m\u001b[1;32m   1674\u001b[0m                 \u001b[0minput_ids\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1675\u001b[0m                 \u001b[0mlogits_processor\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mlogits_processor\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/generation/utils.py\u001b[0m in \u001b[0;36mgreedy_search\u001b[0;34m(self, input_ids, logits_processor, stopping_criteria, max_length, pad_token_id, eos_token_id, output_attentions, output_hidden_states, output_scores, return_dict_in_generate, synced_gpus, streamer, **model_kwargs)\u001b[0m\n\u001b[1;32m   2519\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2520\u001b[0m             \u001b[0;31m# forward pass to get next token\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2521\u001b[0;31m             outputs = self(\n\u001b[0m\u001b[1;32m   2522\u001b[0m                 \u001b[0;34m**\u001b[0m\u001b[0mmodel_inputs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2523\u001b[0m                 \u001b[0mreturn_dict\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1516\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_compiled_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# type: ignore[misc]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1517\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1518\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1519\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1520\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1525\u001b[0m                 \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_pre_hooks\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_hooks\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1526\u001b[0m                 or _global_forward_hooks or _global_forward_pre_hooks):\n\u001b[0;32m-> 1527\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mforward_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1528\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1529\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/accelerate/hooks.py\u001b[0m in \u001b[0;36mnew_forward\u001b[0;34m(module, *args, **kwargs)\u001b[0m\n\u001b[1;32m    162\u001b[0m                 \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    163\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 164\u001b[0;31m             \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    165\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_hf_hook\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpost_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodule\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moutput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    166\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/models/llama/modeling_llama.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, input_ids, attention_mask, position_ids, past_key_values, inputs_embeds, labels, use_cache, output_attentions, output_hidden_states, return_dict)\u001b[0m\n\u001b[1;32m   1032\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1033\u001b[0m         \u001b[0;31m# decoder outputs consists of (dec_features, layer_state, dec_hidden, dec_attn)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1034\u001b[0;31m         outputs = self.model(\n\u001b[0m\u001b[1;32m   1035\u001b[0m             \u001b[0minput_ids\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0minput_ids\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1036\u001b[0m             \u001b[0mattention_mask\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mattention_mask\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1516\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_compiled_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# type: ignore[misc]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1517\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1518\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1519\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1520\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1525\u001b[0m                 \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_pre_hooks\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_hooks\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1526\u001b[0m                 or _global_forward_hooks or _global_forward_pre_hooks):\n\u001b[0;32m-> 1527\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mforward_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1528\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1529\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/accelerate/hooks.py\u001b[0m in \u001b[0;36mnew_forward\u001b[0;34m(module, *args, **kwargs)\u001b[0m\n\u001b[1;32m    162\u001b[0m                 \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    163\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 164\u001b[0;31m             \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    165\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_hf_hook\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpost_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodule\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moutput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    166\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/models/llama/modeling_llama.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, input_ids, attention_mask, position_ids, past_key_values, inputs_embeds, use_cache, output_attentions, output_hidden_states, return_dict)\u001b[0m\n\u001b[1;32m    920\u001b[0m                 )\n\u001b[1;32m    921\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 922\u001b[0;31m                 layer_outputs = decoder_layer(\n\u001b[0m\u001b[1;32m    923\u001b[0m                     \u001b[0mhidden_states\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    924\u001b[0m                     \u001b[0mattention_mask\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mattention_mask\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1516\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_compiled_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# type: ignore[misc]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1517\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1518\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1519\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1520\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1525\u001b[0m                 \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_pre_hooks\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_hooks\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1526\u001b[0m                 or _global_forward_hooks or _global_forward_pre_hooks):\n\u001b[0;32m-> 1527\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mforward_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1528\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1529\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/accelerate/hooks.py\u001b[0m in \u001b[0;36mnew_forward\u001b[0;34m(module, *args, **kwargs)\u001b[0m\n\u001b[1;32m    162\u001b[0m                 \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    163\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 164\u001b[0;31m             \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    165\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_hf_hook\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpost_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodule\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moutput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    166\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/models/llama/modeling_llama.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, hidden_states, attention_mask, position_ids, past_key_value, output_attentions, use_cache, **kwargs)\u001b[0m\n\u001b[1;32m    670\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    671\u001b[0m         \u001b[0;31m# Self Attention\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 672\u001b[0;31m         hidden_states, self_attn_weights, present_key_value = self.self_attn(\n\u001b[0m\u001b[1;32m    673\u001b[0m             \u001b[0mhidden_states\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mhidden_states\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    674\u001b[0m             \u001b[0mattention_mask\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mattention_mask\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1516\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_compiled_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m  \u001b[0;31m# type: ignore[misc]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1517\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1518\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1519\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1520\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_call_impl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1525\u001b[0m                 \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_pre_hooks\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0m_global_backward_hooks\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1526\u001b[0m                 or _global_forward_hooks or _global_forward_pre_hooks):\n\u001b[0;32m-> 1527\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mforward_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1528\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1529\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/accelerate/hooks.py\u001b[0m in \u001b[0;36mnew_forward\u001b[0;34m(module, *args, **kwargs)\u001b[0m\n\u001b[1;32m    162\u001b[0m                 \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    163\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 164\u001b[0;31m             \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_old_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    165\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_hf_hook\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpost_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodule\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moutput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    166\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/models/llama/modeling_llama.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, hidden_states, attention_mask, position_ids, past_key_value, output_attentions, use_cache, **kwargs)\u001b[0m\n\u001b[1;32m    404\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    405\u001b[0m         \u001b[0;31m# upcast attention to fp32\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 406\u001b[0;31m         \u001b[0mattn_weights\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnn\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfunctional\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msoftmax\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mattn_weights\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdim\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdtype\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfloat32\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mto\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mquery_states\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    407\u001b[0m         \u001b[0mattn_output\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmatmul\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mattn_weights\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mvalue_states\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    408\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/nn/functional.py\u001b[0m in \u001b[0;36msoftmax\u001b[0;34m(input, dim, _stacklevel, dtype)\u001b[0m\n\u001b[1;32m   1856\u001b[0m         \u001b[0mret\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msoftmax\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdim\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1857\u001b[0m     \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1858\u001b[0;31m         \u001b[0mret\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msoftmax\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdim\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdtype\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1859\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mret\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1860\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mOutOfMemoryError\u001b[0m: CUDA out of memory. Tried to allocate 1.99 GiB. GPU 0 has a total capacty of 14.75 GiB of which 1.74 GiB is free. Process 2363 has 13.01 GiB memory in use. Of the allocated memory 9.87 GiB is allocated by PyTorch, and 2.12 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF"]}]},{"cell_type":"code","source":["df = pd.DataFrame.from_dict(results)"],"metadata":{"id":"NNA_m2--eLJL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":293},"id":"djZmLTZ6fC4D","executionInfo":{"status":"ok","timestamp":1701085410548,"user_tz":-60,"elapsed":57,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"1571bb1f-d9e9-4951-9a97-9873bab5139a"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                            question  \\\n","0                        what is the document about?   \n","1                 Was muss ich beim Filter beachten?   \n","2  Welche Schäden können an der Waschmaschine im ...   \n","3          Wo finde ich Sammelstellen für Altgeräte?   \n","4  Welche Gefahren habe ich mit dieser Waschmasch...   \n","\n","                                              answer  \\\n","0   This document appears to be instructions for ...   \n","1   Beim Filter musst du folgende Punkte beachten...   \n","2   Während des Betriebs einer Waschmaschine könn...   \n","3   Um Sammelstellen für Altgeräte zu finden, kon...   \n","4   Bei der Verwendung einer Waschmaschine gibt e...   \n","\n","                                              memory  \\\n","0  [content='Wie lauten die Anweisungen für den A...   \n","1  [content='Wie lauten die Anweisungen für den A...   \n","2  [content='Wie lauten die Anweisungen für den A...   \n","3  [content='Wie lauten die Anweisungen für den A...   \n","4  [content='Wie lauten die Anweisungen für den A...   \n","\n","                                             sources  \n","0  {'/content/drive/MyDrive/Colab Notebooks/machi...  \n","1  {'/content/drive/MyDrive/Colab Notebooks/machi...  \n","2  {'/content/drive/MyDrive/Colab Notebooks/machi...  \n","3  {'/content/drive/MyDrive/Colab Notebooks/machi...  \n","4  {'/content/drive/MyDrive/Colab Notebooks/machi...  "],"text/html":["\n","  <div id=\"df-99f463d3-9612-4338-ad2a-0cda5937f50a\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>question</th>\n","      <th>answer</th>\n","      <th>memory</th>\n","      <th>sources</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>what is the document about?</td>\n","      <td>This document appears to be instructions for ...</td>\n","      <td>[content='Wie lauten die Anweisungen für den A...</td>\n","      <td>{'/content/drive/MyDrive/Colab Notebooks/machi...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Was muss ich beim Filter beachten?</td>\n","      <td>Beim Filter musst du folgende Punkte beachten...</td>\n","      <td>[content='Wie lauten die Anweisungen für den A...</td>\n","      <td>{'/content/drive/MyDrive/Colab Notebooks/machi...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Welche Schäden können an der Waschmaschine im ...</td>\n","      <td>Während des Betriebs einer Waschmaschine könn...</td>\n","      <td>[content='Wie lauten die Anweisungen für den A...</td>\n","      <td>{'/content/drive/MyDrive/Colab Notebooks/machi...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Wo finde ich Sammelstellen für Altgeräte?</td>\n","      <td>Um Sammelstellen für Altgeräte zu finden, kon...</td>\n","      <td>[content='Wie lauten die Anweisungen für den A...</td>\n","      <td>{'/content/drive/MyDrive/Colab Notebooks/machi...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Welche Gefahren habe ich mit dieser Waschmasch...</td>\n","      <td>Bei der Verwendung einer Waschmaschine gibt e...</td>\n","      <td>[content='Wie lauten die Anweisungen für den A...</td>\n","      <td>{'/content/drive/MyDrive/Colab Notebooks/machi...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-99f463d3-9612-4338-ad2a-0cda5937f50a')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-99f463d3-9612-4338-ad2a-0cda5937f50a button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-99f463d3-9612-4338-ad2a-0cda5937f50a');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-d713fd40-7780-425b-848f-fd86ee21fed2\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-d713fd40-7780-425b-848f-fd86ee21fed2')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-d713fd40-7780-425b-848f-fd86ee21fed2 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":53}]},{"cell_type":"code","source":["df.to_excel(\"/content/drive/MyDrive/Colab Notebooks/\"+experiment_name+\".xlsx\")"],"metadata":{"id":"ti6MTwJcfKgE"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["####### Random tests #############\n","query = \"Kann ich durch Betrachten der Waschmaschine einen Zustand tiefer innerer Entspannung erreichen?\"\n","response = pdf_qa({\"question\": query})\n","process_llm_response(response)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":734},"id":"iAS9jkeQjbO_","executionInfo":{"status":"error","timestamp":1701260894851,"user_tz":-60,"elapsed":37842,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"77c96a84-e75c-4878-bfef-0d6cf87e03c0"},"execution_count":63,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:chromadb.segment.impl.vector.local_persistent_hnsw:Number of requested results 20 is greater than number of elements in index 1, updating n_results = 1\n","/usr/local/lib/python3.10/dist-packages/transformers/generation/configuration_utils.py:386: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.\n","  warnings.warn(\n","/usr/local/lib/python3.10/dist-packages/transformers/generation/configuration_utils.py:396: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `10` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.\n","  warnings.warn(\n","/usr/local/lib/python3.10/dist-packages/transformers/generation/configuration_utils.py:386: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.\n","  warnings.warn(\n","/usr/local/lib/python3.10/dist-packages/transformers/generation/configuration_utils.py:396: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `10` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.\n","  warnings.warn(\n"]},{"output_type":"stream","name":"stdout","text":[" Es tut mir leid, aber es gibt keine direkte Möglichkeit, einen Zustand tieferer innerer Entspannung durch die\n","Betrachtung einer Waschmaschine zu erreichen. Die Hauptfunktion einer Waschmaschine besteht darin, Kleidung zu\n","waschen und sie sauber zu halten. Obwohl die Betrachtung einer Waschmaschine möglicherweise ein Gefühl der\n","Ruhe und Ordnung vermitteln kann, ist dies kein bewusster Weg, um tiefe innere Entspannung zu erreichen.\n","\n","Um tiefe innere Entspannung zu erreichen, empfehle ich Ihnen, andere Methoden auszuprobieren, wie zum Beispiel\n","Meditation, Yoga, Atemübungen oder andere Techniken, die darauf abzielen, das Bewusstsein zu klären und Stress\n","abzubauen. Diese Praktiken können Ihnen dabei helfen, ein Gefühl der Ruhe und Entspannung zu erleben, auch\n","wenn Sie nicht direkt mit einer Waschmaschine interagieren.\n","\n","\n","Sources:\n"]},{"output_type":"error","ename":"KeyError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyError\u001b[0m                                  Traceback (most recent call last)","\u001b[0;32m<ipython-input-63-9f0808ab70dd>\u001b[0m in \u001b[0;36m<cell line: 4>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0mquery\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m\"Kann ich durch Betrachten der Waschmaschine einen Zustand tiefer innerer Entspannung erreichen?\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0mresponse\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mpdf_qa\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m{\u001b[0m\u001b[0;34m\"question\"\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mquery\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 4\u001b[0;31m \u001b[0mprocess_llm_response\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mresponse\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m<ipython-input-55-0561f139fc91>\u001b[0m in \u001b[0;36mprocess_llm_response\u001b[0;34m(llm_response)\u001b[0m\n\u001b[1;32m     20\u001b[0m     \u001b[0msources\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdefaultdict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlist\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     21\u001b[0m     \u001b[0;32mfor\u001b[0m \u001b[0msource\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mllm_response\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"source_documents\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 22\u001b[0;31m         \u001b[0msource_document\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0msource\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmetadata\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'source'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     23\u001b[0m         \u001b[0msource_page\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0msource\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmetadata\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'page'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     24\u001b[0m         \u001b[0msources\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0msource_document\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0msource_page\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyError\u001b[0m: 'source'"]}]},{"cell_type":"code","source":["response"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"haqZDbeTGQ6o","executionInfo":{"status":"ok","timestamp":1701261679078,"user_tz":-60,"elapsed":676,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"ccc2ff55-a8a9-49cf-d532-661cfa1804ee"},"execution_count":73,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'question': 'Kann ich durch Betrachten der Waschmaschine einen Zustand tiefer innerer Entspannung erreichen?',\n"," 'chat_history': \"question: what is the document about?\\nanswer:  This document appears to be instructions for a washing machine. It provides information on how to use the machine safely and efficiently, including tips for reducing energy consumption and preventing damage to the machine. The document also includes specifications for various wash programs and their respective water temperatures, as well as guidelines for loading and unloading laundry. Additionally, it warns against leaving the detergent compartment open during a wash cycle and advises users to follow recommended heights when placing laundry in the machine to avoid issues with water drainage. \\nsource_documents: [Document(page_content='> 1000 rpm\\\\nPflegeleicht 60\\\\n3\\\\n45\\\\n1.00\\\\n01:48\\\\n45\\\\n40\\\\nPflegeleicht 40\\\\n3\\\\n45\\\\n0.45\\\\n01:23\\\\n45\\\\n40\\\\n* Die Dauer des ausgewählten Programms erscheint im Display der Maschine. Dabei kann es durchaus zu kleinen \\\\nAbweichungen zwischen der angezeigten und der tatsächlichen Dauer kommen.\\\\n** Die Restfeuchtigkeit hängt von der gewählten Schleudergeschwindigkeit ab.', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 19, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}), Document(page_content='•�Lassen�Sie�die�Waschmittelschublade�niemals�\\\\ngeöffnet, während ein Waschprogramm läuft!', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 10, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}), Document(page_content='Beladung. Der tatsächliche Wasserverbrauch hängt von der Art und Weise der Nutzung des Gerätes ab.\\\\n(4)Skala von A (höchste Effizienz) bis G (niedrigste Effizienz)\\\\n(5)„60 °C-Baumwollstandardprogramm“ und „40 °C-Baumwollstandardprogramm“ sind die Standardwaschprogramme, auf \\\\ndenen die Angaben des Kennzeichnungsschildes und des Datenblattes beruhen. Diese Programme eignen sich zum Reinigen', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 35, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}), Document(page_content='(bis etwa 40 cm über dem Boden) und \\\\ndanach wieder nach oben verläuft, kann es zu \\\\nSchwierigkeiten beim Wasserablauf kommen; \\\\nes kann vorkommen, dass die Wäsche beim \\\\nHerausnehmen noch sehr nass ist. Halten Sie sich \\\\ndeshalb an die in der Abbildung angegebenen \\\\nHöhen.\\\\n•�Damit�kein�verschmutztes�Wasser�in�die�Maschine�\\\\nzurücklaufen kann und um der Maschine das \\\\nAbpumpen zu erleichtern, darf das Ende des \\\\nSchlauches nur maximal 15 cm tief in den Ablauf', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 6, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''})]\",\n"," 'answer': ' Es tut mir leid, aber es gibt keine direkte Möglichkeit, einen Zustand tieferer innerer Entspannung durch die Betrachtung einer Waschmaschine zu erreichen. Die Hauptfunktion einer Waschmaschine besteht darin, Kleidung zu waschen und sie sauber zu halten. Obwohl die Betrachtung einer Waschmaschine möglicherweise ein Gefühl der Ruhe und Ordnung vermitteln kann, ist dies kein bewusster Weg, um tiefe innere Entspannung zu erreichen.\\n\\nUm tiefe innere Entspannung zu erreichen, empfehle ich Ihnen, andere Methoden auszuprobieren, wie zum Beispiel Meditation, Yoga, Atemübungen oder andere Techniken, die darauf abzielen, das Bewusstsein zu klären und Stress abzubauen. Diese Praktiken können Ihnen dabei helfen, ein Gefühl der Ruhe und Entspannung zu erleben, auch wenn Sie nicht direkt mit einer Waschmaschine interagieren. ',\n"," 'source_documents': [Document(page_content=\"question: Kann ich durch Betrachten der Waschmaschine einen Zustand tiefer innerer Entspannung erreichen?\\nanswer:  Ja, durch regelmäßiges Durchführen von Wartungsprogrammen wie dem oben genannten Programm kann man den Zustand der Waschmaschine verbessern und einen Zustand tieferer innerer Entspannung erreichen. Dies hilft, dass die Maschine effizienter funktioniert und ihre Lebensdauer verlängert wird. \\nsource_documents: [Document(page_content='nicht, damit es nicht zu Beschädigungen der Maschine oder ihrer Umgebung kommt. In diesem \\\\nFall sollten Sie die Wäsche auflockern, gleichmäßiger verteilen und erneut schleudern.\\\\nDie Programmdauer wird nicht heruntergezählt.\\\\n•�Dies�kann�an�ungleichmäßiger�Verteilung�der�Wäsche�in�der�Maschine�liegen.�>>>�Bei sehr \\\\nungleichmäßiger Wäscheverteilung spricht eine spezielle Schutzschaltung an.\\\\nC \\\\nBei unregelmäßiger Wäscheverteilung (Unwucht) in der Trommel schleudert die Maschine', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 30, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}), Document(page_content='nicht, damit es nicht zu Beschädigungen der Maschine oder ihrer Umgebung kommt. In diesem \\\\nFall sollten Sie die Wäsche auflockern, gleichmäßiger verteilen und erneut schleudern.\\\\nDie Maschine schleudert nicht.\\\\n•�Dies�kann�an�ungleichmäßiger�Verteilung�der�Wäsche�in�der�Maschine�liegen.�>>>�Bei sehr \\\\nungleichmäßiger Wäscheverteilung spricht eine spezielle Schutzschaltung an.\\\\nC \\\\nBei unregelmäßiger Wäscheverteilung (Unwucht) in der Trommel schleudert die Maschine', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 30, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}), Document(page_content='•�Lassen�Sie�die�Waschmittelschublade�niemals�\\\\ngeöffnet, während ein Waschprogramm läuft!', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 10, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}), Document(page_content='alle 1 – 2 Monate; so bleibt die nötige Hygiene \\\\nerhalten. Lassen Sie dieses Programm ohne \\\\nWäsche in der Maschine durchlaufen. Um einen \\\\nnoch besseren Reinigungseffekt zu erzielen, geben \\\\nSie Kalkentferner für Waschmaschinen in das \\\\nWaschmittelfach II. Nach Abschluss des Programms \\\\nlassen Sie die Waschmaschinentür offen stehen, \\\\ndamit das Innere der Maschine trocknen kann. \\\\nC \\\\nHierbei handelt es sich nicht um \\\\nein Waschprogramm, sondern um ein \\\\nWartungsprogramm.\\\\nC', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 16, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''})]\"),\n","  Document(page_content='(bis etwa 40 cm über dem Boden) und \\ndanach wieder nach oben verläuft, kann es zu \\nSchwierigkeiten beim Wasserablauf kommen; \\nes kann vorkommen, dass die Wäsche beim \\nHerausnehmen noch sehr nass ist. Halten Sie sich \\ndeshalb an die in der Abbildung angegebenen \\nHöhen.\\n•�Damit�kein�verschmutztes�Wasser�in�die�Maschine�\\nzurücklaufen kann und um der Maschine das \\nAbpumpen zu erleichtern, darf das Ende des \\nSchlauches nur maximal 15 cm tief in den Ablauf', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 6, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}),\n","  Document(page_content='regelmäßig. Lesen Sie dazu bitte unter „Waschmaschinentür und Trommel \\nreinigen“ nach.', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 32, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''}),\n","  Document(page_content='nicht, damit es nicht zu Beschädigungen der Maschine oder ihrer Umgebung kommt. In diesem \\nFall sollten Sie die Wäsche auflockern, gleichmäßiger verteilen und erneut schleudern.', metadata={'author': '', 'creationDate': '', 'creator': '', 'file_path': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'format': 'PDF 1.5', 'keywords': '', 'modDate': 'D:20231123091019Z', 'page': 29, 'producer': 'iLovePDF', 'source': '/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf', 'subject': '', 'title': '', 'total_pages': 36, 'trapped': ''})]}"]},"metadata":{},"execution_count":73}]},{"cell_type":"code","source":["memory.load_memory_variables({\"prompt\": \"Kann ich durch Betrachten der Waschmaschine einen Zustand tiefer innerer Entspannung erreichen?\"})[\"chat_history\"]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":263},"id":"bDcSmOISVaRo","executionInfo":{"status":"ok","timestamp":1701261628744,"user_tz":-60,"elapsed":374,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"ef8a3a94-d257-47bb-fe9f-24ee79971cde"},"execution_count":72,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:chromadb.segment.impl.vector.local_persistent_hnsw:Number of requested results 20 is greater than number of elements in index 2, updating n_results = 2\n"]},{"output_type":"execute_result","data":{"text/plain":["'question: Kann ich durch Betrachten der Waschmaschine einen Zustand tiefer innerer Entspannung erreichen?\\nanswer:  Es tut mir leid, aber es gibt keine direkte Möglichkeit, einen Zustand tieferer innerer Entspannung durch die Betrachtung einer Waschmaschine zu erreichen. Die Hauptfunktion einer Waschmaschine besteht darin, Kleidung zu waschen und sie sauber zu halten. Obwohl die Betrachtung einer Waschmaschine möglicherweise ein Gefühl der Ruhe und Ordnung vermitteln kann, ist dies kein bewusster Weg, um tiefe innere Entspannung zu erreichen.\\n\\nUm tiefe innere Entspannung zu erreichen, empfehle ich Ihnen, andere Methoden auszuprobieren, wie zum Beispiel Meditation, Yoga, Atemübungen oder andere Techniken, die darauf abzielen, das Bewusstsein zu klären und Stress abzubauen. Diese Praktiken können Ihnen dabei helfen, ein Gefühl der Ruhe und Entspannung zu erleben, auch wenn Sie nicht direkt mit einer Waschmaschine interagieren. \\nsource_documents: [Document(page_content=\"question: Kann ich durch Betrachten der Waschmaschine einen Zustand tiefer innerer Entspannung erreichen?\\\\nanswer:  Ja, durch regelmäßiges Durchführen von Wartungsprogrammen wie dem oben genannten Programm kann man den Zustand der Waschmaschine verbessern und einen Zustand tieferer innerer Entspannung erreichen. Dies hilft, dass die Maschine effizienter funktioniert und ihre Lebensdauer verlängert wird. \\\\nsource_documents: [Document(page_content=\\'nicht, damit es nicht zu Beschädigungen der Maschine oder ihrer Umgebung kommt. In diesem \\\\\\\\nFall sollten Sie die Wäsche auflockern, gleichmäßiger verteilen und erneut schleudern.\\\\\\\\nDie Programmdauer wird nicht heruntergezählt.\\\\\\\\n•�Dies�kann�an�ungleichmäßiger�Verteilung�der�Wäsche�in�der�Maschine�liegen.�>>>�Bei sehr \\\\\\\\nungleichmäßiger Wäscheverteilung spricht eine spezielle Schutzschaltung an.\\\\\\\\nC \\\\\\\\nBei unregelmäßiger Wäscheverteilung (Unwucht) in der Trommel schleudert die Maschine\\', metadata={\\'author\\': \\'\\', \\'creationDate\\': \\'\\', \\'creator\\': \\'\\', \\'file_path\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'format\\': \\'PDF 1.5\\', \\'keywords\\': \\'\\', \\'modDate\\': \\'D:20231123091019Z\\', \\'page\\': 30, \\'producer\\': \\'iLovePDF\\', \\'source\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'subject\\': \\'\\', \\'title\\': \\'\\', \\'total_pages\\': 36, \\'trapped\\': \\'\\'}), Document(page_content=\\'nicht, damit es nicht zu Beschädigungen der Maschine oder ihrer Umgebung kommt. In diesem \\\\\\\\nFall sollten Sie die Wäsche auflockern, gleichmäßiger verteilen und erneut schleudern.\\\\\\\\nDie Maschine schleudert nicht.\\\\\\\\n•�Dies�kann�an�ungleichmäßiger�Verteilung�der�Wäsche�in�der�Maschine�liegen.�>>>�Bei sehr \\\\\\\\nungleichmäßiger Wäscheverteilung spricht eine spezielle Schutzschaltung an.\\\\\\\\nC \\\\\\\\nBei unregelmäßiger Wäscheverteilung (Unwucht) in der Trommel schleudert die Maschine\\', metadata={\\'author\\': \\'\\', \\'creationDate\\': \\'\\', \\'creator\\': \\'\\', \\'file_path\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'format\\': \\'PDF 1.5\\', \\'keywords\\': \\'\\', \\'modDate\\': \\'D:20231123091019Z\\', \\'page\\': 30, \\'producer\\': \\'iLovePDF\\', \\'source\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'subject\\': \\'\\', \\'title\\': \\'\\', \\'total_pages\\': 36, \\'trapped\\': \\'\\'}), Document(page_content=\\'•�Lassen�Sie�die�Waschmittelschublade�niemals�\\\\\\\\ngeöffnet, während ein Waschprogramm läuft!\\', metadata={\\'author\\': \\'\\', \\'creationDate\\': \\'\\', \\'creator\\': \\'\\', \\'file_path\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'format\\': \\'PDF 1.5\\', \\'keywords\\': \\'\\', \\'modDate\\': \\'D:20231123091019Z\\', \\'page\\': 10, \\'producer\\': \\'iLovePDF\\', \\'source\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'subject\\': \\'\\', \\'title\\': \\'\\', \\'total_pages\\': 36, \\'trapped\\': \\'\\'}), Document(page_content=\\'alle 1 – 2 Monate; so bleibt die nötige Hygiene \\\\\\\\nerhalten. Lassen Sie dieses Programm ohne \\\\\\\\nWäsche in der Maschine durchlaufen. Um einen \\\\\\\\nnoch besseren Reinigungseffekt zu erzielen, geben \\\\\\\\nSie Kalkentferner für Waschmaschinen in das \\\\\\\\nWaschmittelfach II. Nach Abschluss des Programms \\\\\\\\nlassen Sie die Waschmaschinentür offen stehen, \\\\\\\\ndamit das Innere der Maschine trocknen kann. \\\\\\\\nC \\\\\\\\nHierbei handelt es sich nicht um \\\\\\\\nein Waschprogramm, sondern um ein \\\\\\\\nWartungsprogramm.\\\\\\\\nC\\', metadata={\\'author\\': \\'\\', \\'creationDate\\': \\'\\', \\'creator\\': \\'\\', \\'file_path\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'format\\': \\'PDF 1.5\\', \\'keywords\\': \\'\\', \\'modDate\\': \\'D:20231123091019Z\\', \\'page\\': 16, \\'producer\\': \\'iLovePDF\\', \\'source\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'subject\\': \\'\\', \\'title\\': \\'\\', \\'total_pages\\': 36, \\'trapped\\': \\'\\'})]\"), Document(page_content=\\'(bis etwa 40 cm über dem Boden) und \\\\ndanach wieder nach oben verläuft, kann es zu \\\\nSchwierigkeiten beim Wasserablauf kommen; \\\\nes kann vorkommen, dass die Wäsche beim \\\\nHerausnehmen noch sehr nass ist. Halten Sie sich \\\\ndeshalb an die in der Abbildung angegebenen \\\\nHöhen.\\\\n•�Damit�kein�verschmutztes�Wasser�in�die�Maschine�\\\\nzurücklaufen kann und um der Maschine das \\\\nAbpumpen zu erleichtern, darf das Ende des \\\\nSchlauches nur maximal 15 cm tief in den Ablauf\\', metadata={\\'author\\': \\'\\', \\'creationDate\\': \\'\\', \\'creator\\': \\'\\', \\'file_path\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'format\\': \\'PDF 1.5\\', \\'keywords\\': \\'\\', \\'modDate\\': \\'D:20231123091019Z\\', \\'page\\': 6, \\'producer\\': \\'iLovePDF\\', \\'source\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'subject\\': \\'\\', \\'title\\': \\'\\', \\'total_pages\\': 36, \\'trapped\\': \\'\\'}), Document(page_content=\\'regelmäßig. Lesen Sie dazu bitte unter „Waschmaschinentür und Trommel \\\\nreinigen“ nach.\\', metadata={\\'author\\': \\'\\', \\'creationDate\\': \\'\\', \\'creator\\': \\'\\', \\'file_path\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'format\\': \\'PDF 1.5\\', \\'keywords\\': \\'\\', \\'modDate\\': \\'D:20231123091019Z\\', \\'page\\': 32, \\'producer\\': \\'iLovePDF\\', \\'source\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'subject\\': \\'\\', \\'title\\': \\'\\', \\'total_pages\\': 36, \\'trapped\\': \\'\\'}), Document(page_content=\\'nicht, damit es nicht zu Beschädigungen der Maschine oder ihrer Umgebung kommt. In diesem \\\\nFall sollten Sie die Wäsche auflockern, gleichmäßiger verteilen und erneut schleudern.\\', metadata={\\'author\\': \\'\\', \\'creationDate\\': \\'\\', \\'creator\\': \\'\\', \\'file_path\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'format\\': \\'PDF 1.5\\', \\'keywords\\': \\'\\', \\'modDate\\': \\'D:20231123091019Z\\', \\'page\\': 29, \\'producer\\': \\'iLovePDF\\', \\'source\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'subject\\': \\'\\', \\'title\\': \\'\\', \\'total_pages\\': 36, \\'trapped\\': \\'\\'})]\\nquestion: what is the document about?\\nanswer:  This document appears to be instructions for a washing machine. It provides information on how to use the machine safely and efficiently, including tips for reducing energy consumption and preventing damage to the machine. The document also includes specifications for various wash programs and their respective water temperatures, as well as guidelines for loading and unloading laundry. Additionally, it warns against leaving the detergent compartment open during a wash cycle and advises users to follow recommended heights when placing laundry in the machine to avoid issues with water drainage. \\nsource_documents: [Document(page_content=\\'> 1000 rpm\\\\nPflegeleicht 60\\\\n3\\\\n45\\\\n1.00\\\\n01:48\\\\n45\\\\n40\\\\nPflegeleicht 40\\\\n3\\\\n45\\\\n0.45\\\\n01:23\\\\n45\\\\n40\\\\n* Die Dauer des ausgewählten Programms erscheint im Display der Maschine. Dabei kann es durchaus zu kleinen \\\\nAbweichungen zwischen der angezeigten und der tatsächlichen Dauer kommen.\\\\n** Die Restfeuchtigkeit hängt von der gewählten Schleudergeschwindigkeit ab.\\', metadata={\\'author\\': \\'\\', \\'creationDate\\': \\'\\', \\'creator\\': \\'\\', \\'file_path\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'format\\': \\'PDF 1.5\\', \\'keywords\\': \\'\\', \\'modDate\\': \\'D:20231123091019Z\\', \\'page\\': 19, \\'producer\\': \\'iLovePDF\\', \\'source\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'subject\\': \\'\\', \\'title\\': \\'\\', \\'total_pages\\': 36, \\'trapped\\': \\'\\'}), Document(page_content=\\'•�Lassen�Sie�die�Waschmittelschublade�niemals�\\\\ngeöffnet, während ein Waschprogramm läuft!\\', metadata={\\'author\\': \\'\\', \\'creationDate\\': \\'\\', \\'creator\\': \\'\\', \\'file_path\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'format\\': \\'PDF 1.5\\', \\'keywords\\': \\'\\', \\'modDate\\': \\'D:20231123091019Z\\', \\'page\\': 10, \\'producer\\': \\'iLovePDF\\', \\'source\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'subject\\': \\'\\', \\'title\\': \\'\\', \\'total_pages\\': 36, \\'trapped\\': \\'\\'}), Document(page_content=\\'Beladung. Der tatsächliche Wasserverbrauch hängt von der Art und Weise der Nutzung des Gerätes ab.\\\\n(4)Skala von A (höchste Effizienz) bis G (niedrigste Effizienz)\\\\n(5)„60 °C-Baumwollstandardprogramm“ und „40 °C-Baumwollstandardprogramm“ sind die Standardwaschprogramme, auf \\\\ndenen die Angaben des Kennzeichnungsschildes und des Datenblattes beruhen. Diese Programme eignen sich zum Reinigen\\', metadata={\\'author\\': \\'\\', \\'creationDate\\': \\'\\', \\'creator\\': \\'\\', \\'file_path\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'format\\': \\'PDF 1.5\\', \\'keywords\\': \\'\\', \\'modDate\\': \\'D:20231123091019Z\\', \\'page\\': 35, \\'producer\\': \\'iLovePDF\\', \\'source\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'subject\\': \\'\\', \\'title\\': \\'\\', \\'total_pages\\': 36, \\'trapped\\': \\'\\'}), Document(page_content=\\'(bis etwa 40 cm über dem Boden) und \\\\ndanach wieder nach oben verläuft, kann es zu \\\\nSchwierigkeiten beim Wasserablauf kommen; \\\\nes kann vorkommen, dass die Wäsche beim \\\\nHerausnehmen noch sehr nass ist. Halten Sie sich \\\\ndeshalb an die in der Abbildung angegebenen \\\\nHöhen.\\\\n•�Damit�kein�verschmutztes�Wasser�in�die�Maschine�\\\\nzurücklaufen kann und um der Maschine das \\\\nAbpumpen zu erleichtern, darf das Ende des \\\\nSchlauches nur maximal 15 cm tief in den Ablauf\\', metadata={\\'author\\': \\'\\', \\'creationDate\\': \\'\\', \\'creator\\': \\'\\', \\'file_path\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'format\\': \\'PDF 1.5\\', \\'keywords\\': \\'\\', \\'modDate\\': \\'D:20231123091019Z\\', \\'page\\': 6, \\'producer\\': \\'iLovePDF\\', \\'source\\': \\'/content/drive/MyDrive/Colab Notebooks/machine_manual_truncated.pdf\\', \\'subject\\': \\'\\', \\'title\\': \\'\\', \\'total_pages\\': 36, \\'trapped\\': \\'\\'})]'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":72}]},{"cell_type":"code","source":["pdf_qa.combine_docs_chain.llm_chain.prompt"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VQDdpNWZVfTK","executionInfo":{"status":"ok","timestamp":1701086654302,"user_tz":-60,"elapsed":405,"user":{"displayName":"Muhammad Ahsan Ali","userId":"06941653628544840407"}},"outputId":"96bccdad-3a32-4e1c-e365-c3c546df3be4"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["PromptTemplate(input_variables=['context', 'question'], template=\"[INST]<<SYS>>\\nYou are a helpful, respectful and honest assistant. Always answer as helpfully as possible using the context text provided. Your answers should only answer the question once and not have any text after the answer is done.\\n\\nIf a question does not make any sense, or is not factually coherent, explain why instead of answering something not correct. If you don't know the answer to a question, please don't share false information. \\n<</SYS>>\\n\\nCONTEXT:/n/n {context}/n\\n\\nQuestion: {question}[/INST]\")"]},"metadata":{},"execution_count":59}]},{"cell_type":"code","source":[],"metadata":{"id":"gQhBsTOIqmrQ"},"execution_count":null,"outputs":[]}]}